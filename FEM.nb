(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    160744,       4131]
NotebookOptionsPosition[    155778,       4041]
NotebookOutlinePosition[    156294,       4063]
CellTagsIndexPosition[    156227,       4058]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Galerkin Method FEM for Linear PB eqn", "Section",
 CellChangeTimes->{{3.715918723257801*^9, 3.715918734529282*^9}, {
  3.715918785309805*^9, 
  3.715918796733087*^9}},ExpressionUUID->"226fa7c5-2ce5-426c-8770-\
c3176bdd5439"],

Cell[CellGroupData[{

Cell["Obtaining Eqns", "Subsection",
 CellChangeTimes->{{3.7160466530497913`*^9, 
  3.716046658384459*^9}},ExpressionUUID->"75d726f2-f504-43cc-8e29-\
0639c8c4913a"],

Cell[TextData[{
 StyleBox["0. ",
  FontFamily->"Times New Roman",
  FontSize->16],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["d", "2"], 
     RowBox[{
      RowBox[{"\[Psi]", "(", "x", ")"}], "/", 
      SuperscriptBox["dx", "2"]}]}], " ", "=", " ", 
    RowBox[{"-", 
     RowBox[{"f", "(", "x", ")"}]}]}], TraditionalForm]],
  FontFamily->"Times New Roman",
  FontSize->16,ExpressionUUID->"05c3adb2-b736-4648-bbb2-fd5aa33ca8ef"],
 StyleBox["\n1. Discretize domain into elements\n2. Develope (simpler) \
equations to approximate \n    the solution of each element.\n3. Example (2 \
grid points):\n\t",
  FontFamily->"Times New Roman",
  FontSize->16],
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["\[Psi]", "~"], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["N", "1"], "(", "x", ")"}], 
      SubscriptBox["\[Psi]", "1"]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["N", "2"], "(", "x", ")"}], 
      SubscriptBox["\[Psi]", "2"]}]}]}], TraditionalForm]],
  FontFamily->"Times New Roman",
  FontSize->16,ExpressionUUID->"5479ffc1-60c5-4af8-a9d3-c319c18c3357"],
 StyleBox["\n\t",
  FontFamily->"Times New Roman",
  FontSize->16],
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["d", "2"], 
      RowBox[{
       RowBox[{"\[Psi]", "(", "x", ")"}], "/", 
       SuperscriptBox["dx", "2"]}]}], "+", 
     RowBox[{"f", "(", "x", ")"}]}], " ", "=", " ", "0"}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["d", "2"], 
      RowBox[{
       RowBox[{
        OverscriptBox["\[Psi]", "~"], "(", "x", ")"}], "/", 
       SuperscriptBox["dx", "2"]}]}], "+", 
     RowBox[{"f", "(", "x", ")"}]}], " ", "=", " ", 
    RowBox[{"err", "(", "x", ")"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"\[PartialD]", 
       RowBox[{
        SubscriptBox["\[Integral]", "D"], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"err", "(", "x", ")"}], "2"], "dD"}]}]}], 
      RowBox[{"\[PartialD]", 
       SubscriptBox["\[Alpha]", "i"]}]], " ", "=", " ", 
     RowBox[{"0", " ", "=", " ", 
      RowBox[{
       SubscriptBox["\[Integral]", "D"], 
       RowBox[{
        RowBox[{"err", "(", "x", ")"}], 
        RowBox[{
         SubscriptBox["N", "i"], "(", "x", ")"}], "dD"}]}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"where", " ", 
      RowBox[{
       SubscriptBox["N", "i"], "(", "x", ")"}]}], "=", 
     RowBox[{
      FractionBox["\[PartialD]", 
       RowBox[{"\[PartialD]", 
        SubscriptBox["\[Alpha]", "ii"]}]], 
      RowBox[{"err", "(", "x", ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Integral]", "D"], 
     RowBox[{
      RowBox[{"[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["d", "2"], 
         RowBox[{
          RowBox[{
           OverscriptBox["\[Psi]", "~"], "(", "x", ")"}], "/", 
          SuperscriptBox["dx", "2"]}]}], "+", 
        RowBox[{"f", "(", "x", ")"}]}], "]"}], " ", 
      RowBox[{"N", "(", "x", ")"}], " ", "dD"}]}], " ", "=", " ", 
    RowBox[{
     SubscriptBox["\[Integral]", "D"], 
     RowBox[{
      RowBox[{"err", "(", "x", ")"}], " ", 
      RowBox[{"N", "(", "x", ")"}], "dD"}]}]}], TraditionalForm]}],
  FontFamily->"Times New Roman",
  FontSize->16,ExpressionUUID->"bffd574c-c058-41a6-964b-b4a5ad39776a"],
 StyleBox["\n\t\n",
  FontFamily->"Times New Roman",
  FontSize->16],
 Cell[BoxData[
  GraphicsBox[
   TagBox[RasterBox[CompressedData["
1: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
dWF85Eq1e0cDcK1X8mdH3u/4vM15Ja7mnrUAcypznUbzZ0fiiTgvTWz2G9di
MiPHUQBzOXLecTQ2K9cJlP9/+jlNYx8rcK0AwFxG+uPRPjvGH0/v5413rKR2
T7QnH1cBXOnMefvxO56aJ9rWP57DNJeHlbhvIcAczvq98hKLPLlPN6axupxD
A+AaW38c54u98vknnw/J8/2fmDMEAM73zrHyE4+z/XYhAPBJ8f60o7mffM+k
J8jrLFcGAHzS6D0wYnxSzovePVZxbwwA4Aoj5+ny63efR+z8JQBwpaO/IXBH
rd+5AQC4wtPzRH4fGgCYzdPyZ3HunN/CBABm9JS8kftiAACrKLmku8Zn7osB
AKwm3gPtDnKerMRkT/ttAwBgXXc632eePwBwByvnz9zXHwC4q9XyZ3e/Py4A
8Gyr5M9q11/KlQEAdzVrrCMmAwCeqMRAM1zjWPudpVnKBgDwLVvc08pNlXjp
kzmruHzz/AEAflOLzz55r/1ajsw8fwCA3+T8We3/z1hG/s1L5y0BANpyzHRG
TsvcfgCAY0reLP7+Zpn3VZ478l3xczkmkycDAOjL5y5LDHU0b1abQ2YuGQDA
MfkeFqN5s1oMl3NkAAC8Jp6PLLFVPM/ZisPEYgAAnxPjsL14DACA98V7y+Yc
2V5uzFx+AIB9JY9V/u3FWaMPuTEAgNe8Gn/F+WViMQCA943EYBuxFwDAd5Q5
ZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAACwip8/f/71MZNff/11ujKNmrE+V7bV5dYemMuPHz/++uA5
9GvwPTP2sVsfcHaZvrWenyj7k83YPrFdnmbV7b1imWEz4z5X4pszj9NeXc+j
Zfnll1+mq8+Vzdg++W27bG2dZyj74Uq5s9IXr1RmKGYc+87OPb2zjkf7pBnr
c2Xqc07GvGcp++FK++KK8SQUM+5vJTY7Y57ROzm48tkj9eOc5rlmbJ+IzZ5m
xX6t9B3mq7KiGce+M89pvnsu8+hnV+zDZjZj+2T97XJWH/OUa39W3N6fmBsD
3zLjPndW3uydOOnVuQrmm51rxvbJ+nmzM/qYJ439K+6H5puxshn3uav7zW25
r9bLjPW5MvU5p5WvBTgrpnpS21xxXZ3TZGUz7nNn9J1nzP9/hXOa55qxfbLu
dnl1rkLre56Sk1lxe7sWgJXNuM+92++VvNc78/9fXbZzmudaOT9zZ6tul7J/
vptLeVpOZsZxYs9Z2xquMOM+927u6Z3Y6t36mLE+V+a4d06rbpcz9s8n7uMr
rvOKZebzYu5mi9/L9TyzPWLe9+pH+a2mcrxTjsvja/Hv8v9RWadXjpXKct+p
jzj/tLZu5VHaSF63vH5xPWrPveub27W37tu/cf3Kc/rX38V6KX+Xf2vPxX9H
X2v9nT+3Yt7szHOZr6z7N/a1Tz1mGidGH3EceWeda484VpS/83Ojny/ly+Ud
/S7nbo95pW49znscdXV5PTzyGJif8zjn8Y6ry+7hUR61voFxrWPaHOPuHafW
vrN8x8+Qf4jf3zq+rr0WP1vLX5R/Yw6kfG6WR2mfr+SVYnuv1Uus51z35ZHz
Q7M94vFZLnMvFxPfO9s2/0T9/Pz5e24kvlbaR/k712c83i3/nt0XX/04qxyv
5DLy9sivtb4z5ijeyTnXtkPc5jnvXitT7EtinxJfK/tffi7/HT8f9934vpG8
aWs8ya/VxoXa5/N7amNMfq21/Npy8+uxDkcfe+8HzlH6x1f2q9i3AvdS9u93
/LroeVyAK72T0805M+A+zti33zn2A3iid+7/rM+F+zpjHk7JmekjAMa92v+W
uMwcSrifs467zjgnCvAU5Xj21X7TvQnhvs6Y/y+vDnDMu/2mnBnc01n3FdBH
ABzz6nFxzLc5HoZ7OeuaStdvAxz36r1ozO2F+yox1RlzFfQRAAAAAAAAAMAT
zXSPiPxbbK3nZlUr4wrlhhHa9zPVfr9zM+t8u1ZZtVVWUrsO/Kprw2v3e13p
HkK1crrO/j0ztc8nq9W5+64+Q60PnnkfXHkMgSL/ptHV94+I8Vm8n8UKxzx5
rNInvC/fq8DvSl+jdtykbT9D3udm3wfzmPbO7/bBleK9GGdow2VfKv+uJJd9
1v5rJTHGXSlWv5sYJ8+cN+F8cd9bYR+cbUyDV511r+yzrLpP5T6Mc6jTORjv
nisfI81On8EdbMfCM+WpVu7/9Qnn89vzcxCbPVfcB49u+yvm4r8aR86cD+R5
Yju+us9dOfe0ctlnls9RcA2x2XO9ug9etd8eLa/jP2ZT2uPeHKnteOIbxxSx
7x/ZV+I1A6X8V40bR+ebvfrbUk+St+/IXBfXzJ/PfLPnyjmz0bm0sa18s73E
5Y32GZ9q198aN7mXnCvr7UffiCPyskdyeXncvjK/Epc5Uo6zy7nKXJAj4jqN
tAfHv5+R63R0Ozj2WF9t2+/tXzk++lY7yO1upD949XzHyDo5/uYVtWOK1nHG
p/NRteOxmDPpfSaX64rrpmvz9cpzreOms/fbmeYMniVvx71zauVemfrD89TG
rb19rOybR3IGI9tM3P1dte28lzsr/XbZD4+2g3ccGdOKmDMb7TeO5A5dr89R
tTGsdS/+b4x3vX6+9Xyt3ce+4Vtqdfbt3zW4W2zW2r53W8/ZtbbDmX3CaM53
dEzkHK3fBeidq4vx2Lf31VabbPXDeU7PiCPjy5VzbHiGlXIRK51PuWJ8e4IV
tv0THNkOo7GZNj632A/NvK3iOHG0XY2OLyuNm6ypdew8m7ifrTAH88yct3zS
71bZ/nd2ZLw7kjfTxucWz3nOPGbEseJImzry2wjyZnza7HmouJ/NXM7szOMq
49bvVmsHd3R03BOb3cMqffFoOXMMd+Tas9nrgPXNmpst8yFW6AtqeseW+Rr0
+Kitp7zZ71ZsC3e0dx1P71Hbfuabze+Vc4RXGC3nO7HZKuebWNesc5lWjcmK
kZg3rl9vO8y6ja6wcpu4k72cwtHxboUx/+lWme/7TjlH2+GsOQ3uY9bz5qv3
1WceV4nNfrfC2HB3R9rj6H68+v5+d6vkzDa1ecmjfcaR+WbyZnzSjLFZzpnF
8s1W1hbXAnyG2Ox6R3LargVYX56Dsf397fsIjWj9lszo/Mi9+25GM46b3MuM
udlX5wDM5Mxyypv9Tmx2vaPXAYxss1X266fJfe7I3MGr5Db0Sjmd02QWs85p
LG2/9ZjdmfUqb/a72caDJzoSR8mbran0X7X9bcY+uNbfvlLO0Vygc5qwpjNz
XfJmvxObXe8T+Wux2TxWmlsGcITjqs8Qm13P2A3ASuK4JYY4j3qdg7gMgNXE
3/2Y6Rqm1cVrr7iO7QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA6/v58+fu49dff/3ro/VaS/zML7/8
8nefrZUjl6n2nWWZ5fvz9+T3j9bDN/Xq+mxb3a/oE3WxilrbfrJSF3Hf5zef
6jdeUdrt1udsjx8/ftymHW/rsa3P9li1T2Udpa31HiVuaL326veOvP/Ie1pl
7H3nq+V9x0g5z3L29726/L321fvcEz19/bNP7iMrO6s+Wn3SO+VZeVvV+qU7
rBfrKPtkPM5pjZ3x71bbHI2P8mfzMUlt36h9d3zPdsw2uuyR774yNnvnuKwc
u87Qh4y2h7g9ap95kpHY9Wly36ROzt9P3vm+OI7kfnyWnN6osi61sSW3Q/iU
2A5rbTLHZr0xf/TYa+/58j01e7FhfL5W3lb/3opDPxmb1Z7rrduIT8eVr5Yp
r18vzhabic2yWvt5urP6jOjd2OwObba1Dk/uk/i+Wt6sdpwTc1JlPkFun+W5
Mres135ry8gxYs3ee3L5yv5Vyl97LdZDrI+98p6p1s++ssy8fnvb4RtqZYnH
ofFYNL+2ej//ijzOrZZ3+ISclzHf5+/PE7y7n8Q+qNa/j372m/vsq31k63Nx
36utQ5w3PboseEUtb9ZSyyvl19/pK0aOS0bzZnu5sb3Xvh3PnHkMPFveqVeW
3muf7teO1tE361F+6G/Jm7UdiRX2lDZ+tN+o9Z9xPBnpl1vLre2nR/N0tT6x
Np7ldaiNGSNjVO0x+t7W8nmW2A725gfEdpKPq3qvjRqJEUs5W+/J31HrA3p5
s/Ld3zwur+2L7yz/zDjvDL1tVitn2X698tfm1JVl9I6JW3Mqa+2+9/7YdmIu
J5c355vzcsoyYtnj+pfnc7laY02r3dTWpfbdI2L5yiNfn9fbDqVecpnid9WW
Wdt398aw2lhaq7Oj42Gr/lvbIJe/NQaXda+17Vwvsa/q7SdH2vsrfXj8XK1t
tuq8V5dRq/yjbb+3z9e2fe398T2tfqm3nFYZe+3oSHvkfvJ+1WtHtbacX4v/
HjXSL/T2jfh6XK+4nq1+LL4/rmdtPD1LrY8oy3tHXod3v+9drbLUxuby/Mi2
6j1a407u62IZ4mdacUx8vuwftfEv9qN7/XP+TPw7x0+tPrs3Pu+NGXtx1NHv
640ntZh6pEyt2KwX3+Rts1ePI2Pp6PVGebvFzx2pv159xjpp9Zm1+qntc7le
RvvwuD1jO4z7e9ke5T29faCsSxS3ed53c3lbdV7bLuU7Yj3F7437fClj7gd6
9VzacO21vO615e6tH/eW2/teG2q9HttNa4wor5XltvqFXjyRy1l7vdaX9caL
vOze95xptA8+am87fltrm/XWufWZ3rrltpzLcKROem2xty6xjx+pg/jZVnlr
40evHbe+O69Lr7564vf02nDtu2vbr9X31D5Xq6+8fq3lteql9lptObXy916r
fW+tzvN23XttdHnlPdleGVvr3jPaNstrtf2j/HtkXBipnxjnjKzDK31Irz3l
9av1da3l9to291a2eTz2auVb4mvxuGHkOoG4rL2+64y8WS7nXg4p7+M5B/iJ
fSLfmzcub3u8mqs72id9Wm2b1fJPRXxvbgtxe+TcxN4xbayPXt3G98dj2PJ3
znvE9azlr+K65O0R21tv+fm9sSyttll7/8+fv+ej8rqMinWc63Pvmpu8XWs5
rlqZeuNmLa+SX6vlaWId5tdqbS+/lj9XXo/1WspZu/Yl11kt19Srk9p37snL
6a3fkTaR46dam8z9a+212nJzn1x7rbfte+PFkXVo1V0uX205vfEk9021tv3J
cYg5HRnHY7urjT+5/+x9R6tfiGVqfb63r+XviN9V69db333FPtCr3yN6/dUV
att8r35b5c/jc/7uWtvqvVYT28zeMmrLKf+f16W3PrVxIL9W27966zVS9tE6
adVPb7mtMaz1uVodtvbn+Nn83Gj9tsrR6ofyMlrxR23b5bLUXovrkbd5b717
fXerDfTWPfebI/JyWnUT17W13PxarS9vLbf2naPrs7cOe20zP99av14fsLc9
xGbPUbZ57Xguysdv+RgmtqFejJ+PZaL8+ZpW+659R9nP49+t491YD0f7pbPE
/e/ocWvte65cl2hv/Mhi+Wv9WI5z9mKNWBe9Nl7EfFRsr/mRc1bx/fnzte+M
+eZWneVl5HWMdZS/K5c9H/O3Pje6fWr9QF5uHsNa/Udcv15uIraN/LnavlNb
t7yfjebN8nq34o9Y/rztenmzuMx8TcBevi2vZ29eX96/cvl7/WtLLn+rbuK6
1JZbe61X3l6f2YuHanK7zevQamMj/W2v/fbqLq9DrV65p9xmets/tu9aW8+v
9/bP3ud7Y/jevtbaH/fGoRn2gbz8Vh3sla22Ta90tCy5Lfb629HlH9m+veWP
lLv8f3yuNk6OtONaWfe+K48Zn2jTvX6gtu/F51ufK8/31qVVJ7X9e3R/743B
tT4qlrP1vbVy9vrZWJYj/eLeftJr+7luau8dNdLW4rYc2X75u/de6/UVI+uz
10e0+ufa/nikfnJ7za/tlWm0X2UtZZsfyZv9rByjbOLxW/ne/F17fVB8LbbD
fD1Qa18rr+djkNqxfO06sNH9+B0j9Vv+P4plr+X+8vtmypsdKUssf2v8OJJX
jNu2d1zfe/+o3P5rx9eljbXKkpffKmt8Peeact7kzHawVz85N1Ybw0bzZmXd
89hWa/95/+1tu179tvqBXP5WGWJfOjrO5nqp5caO5M1a2z1us17e7Gi738s5
jdRr3C+ivO1br7XynK3tEd9X1iG3n1z+vJ9tan13rU3Vtm98rXw2v9bqK2I5
9sYE1lNr263zPa22md9Te8T9bqRPj/+f22atL8rLz/tIrY+LbTmWLfcVsexn
jG+5TnKZ4/ha+9xefJHLv2ps1utv99prWfcit6f4/7V6ytsjj+Gt5efvrsUX
e/tQXsfYhltjS6uN1vah2v1FWm2pZm8/zm0vfndv241cC7A3xub1ba1XLEdt
DG7FAjmuid9fu2dD/t7W+D0Sf+W6rl13UdsGsR729p9XY7O8v9TqvTYu5Pqs
bY/ets+vtWK31nLj99X6iPh67fO95eTvadVNr+7y9jiy7qxtpO203nf0vbXH
kc9tep+vvZ7beevzr5T3VSPLGenbWmr1eKXc9+yJ40ftM7GOjmyrI9v3zDZc
K0P+/1595XE1Pt8q55F1PtpGeuv46j6+1w+Ntulcv73YbG8bvdOORj7X2q65
3Hufq+0nrTo++tqokfV/dZ862r7zNt9bbm877O1ne210r2x77+mte60/4D5a
uaosxuitGD+/P8bzo/1X63Nl/6i9lsvYW0bt8yPlPNpX9Yzu61meM7z3nk+U
/ahXytLa/iPfu7eM3rau9el7bWPv2KSVA+iVsbUuI31/rV2M3C+11Z5qSr3E
+mnV08gxxt7nWuXfq/uj9dur49r69+qylptslf/V13r7Sa3Oet95pI5rSnuI
j5pSd/H95fna52vP53goP1pzRuJ2a5Wz1jdvn433O9pbVv6Ovfp4Z/3KOrXK
Ap8y2jcwr6PbMPdpo+Pw3pj8Trniskb1xra9dSr/lvfmz76yzq36OiqWLZdz
dFzvbbt39/m9bVWLtVp/H12H3nuPvFae23stLrO2/F5d5H2r1s4AgPnFMb02
7+aIeK+Is5wV4wEArKB23mcWM5YJAOCTenmzK4zMTwQAuKtaLHTVPOScvzMn
GgB4mnitQp6P/m3yYwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAT/D/H7vyi

     "], {{0, 412}, {615, 0}}, {0, 255},
     ColorFunction->RGBColor],
    BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
    Selectable->False],
   BaseStyle->"ImageGraphics",
   ImageSize->{385.5859375, Automatic},
   ImageSizeRaw->{615, 412},
   PlotRange->{{0, 615}, {0, 412}}]], "Input",
  FontFamily->"Times New Roman",
  FontSize->16,
  FontWeight->"Plain",ExpressionUUID->
  "64ff4b2a-6f8a-471a-8218-8adfadc4987f"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SubsuperscriptBox["\[Integral]", 
          SubscriptBox["x", "1"], 
          SubscriptBox["x", "2"]], 
         RowBox[{
          FractionBox[
           RowBox[{"d", 
            OverscriptBox["\[Psi]", "~"]}], "dx"], 
          FractionBox[
           SubscriptBox["dN", "1"], 
           RowBox[{"\[PartialD]", "x"}]], 
          RowBox[{"\[DifferentialD]", "x", "   "}]}]}]},
       {
        RowBox[{
         SubsuperscriptBox["\[Integral]", 
          SubscriptBox["x", "1"], 
          SubscriptBox["x", "2"]], 
         RowBox[{
          FractionBox[
           RowBox[{"d", 
            OverscriptBox["\[Psi]", "~"]}], "dx"], 
          FractionBox[
           SubscriptBox["dN", "2"], "dx"], 
          RowBox[{"\[DifferentialD]", "x", "  "}]}]}]}
      }], ")"}], " ", "=", "  ", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         RowBox[{"-", 
          FractionBox[
           RowBox[{"d", 
            RowBox[{
             OverscriptBox["\[Psi]", "~"], "(", 
             SubscriptBox["x", "1"], ")"}]}], "dx"], "  "}]},
        {
         RowBox[{"-", 
          FractionBox[
           RowBox[{"d", 
            RowBox[{
             OverscriptBox["\[Psi]", "~"], "(", 
             SubscriptBox["x", "2"], ")"}]}], "dx"]}]}
       }], ")"}], " ", "+", "  ", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          SubsuperscriptBox["\[Integral]", 
           SubscriptBox["x", "1"], 
           SubscriptBox["x", "2"]], 
          RowBox[{
           RowBox[{"f", "(", "x", ")"}], 
           RowBox[{
            SubscriptBox["N", "1"], "(", "x", ")"}], 
           RowBox[{"\[DifferentialD]", "x", "  "}]}]}]},
        {
         RowBox[{
          SubsuperscriptBox["\[Integral]", 
           SubscriptBox["x", "1"], 
           SubscriptBox["x", "2"]], 
          RowBox[{"f", 
           RowBox[{"(", "x", ")"}], 
           SubscriptBox["N", "2"], 
           RowBox[{"(", "x", ")"}], 
           RowBox[{"\[DifferentialD]", "x", " "}]}]}]}
       }], ")"}]}]}], TraditionalForm]],
  FontFamily->"Times New Roman",
  FontSize->16,ExpressionUUID->"b6c73874-da52-45ee-94f9-8eb0b2eace8a"],
 StyleBox["\n",
  FontFamily->"Times New Roman",
  FontSize->16],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{
       SubscriptBox["x", "2"], "-", 
       SubscriptBox["x", "1"]}]], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"1", " "}], 
         RowBox[{"-", "1"}]},
        {
         RowBox[{"-", "1", " "}], "1"}
       }], ")"}], " ", 
     RowBox[{"(", GridBox[{
        {
         SubscriptBox[
          OverscriptBox["\[Psi]", "~"], "1"]},
        {
         SubscriptBox[
          OverscriptBox["\[Psi]", "~"], "2"]}
       }], ")"}]}], " ", "=", "  ", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         RowBox[{"-", 
          FractionBox[
           RowBox[{"d", 
            OverscriptBox["\[Psi]", "~"], " ", 
            RowBox[{"(", 
             SubscriptBox["x", "1"], ")"}]}], "dx"], "  "}]},
        {
         RowBox[{"-", 
          FractionBox[
           RowBox[{"d", 
            RowBox[{
             OverscriptBox["\[Psi]", "~"], "(", 
             SubscriptBox["x", "2"], ")"}]}], "dx"]}]}
       }], ")"}], "+", "  ", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          SubsuperscriptBox["\[Integral]", 
           SubscriptBox["x", "1"], 
           SubscriptBox["x", "2"]], 
          RowBox[{
           RowBox[{"f", "(", "x", ")"}], 
           RowBox[{
            SubscriptBox["N", "1"], "(", "x", ")"}], 
           RowBox[{"\[DifferentialD]", "x", "  "}]}]}]},
        {
         RowBox[{
          SubsuperscriptBox["\[Integral]", 
           SubscriptBox["x", "1"], 
           SubscriptBox["x", "2"]], 
          RowBox[{"f", 
           RowBox[{"(", "x", ")"}], 
           SubscriptBox["N", "2"], 
           RowBox[{"(", "x", ")"}], 
           RowBox[{"\[DifferentialD]", "x", " "}]}]}]}
       }], ")"}], " ", " "}]}], TraditionalForm]],
  FontFamily->"Times New Roman",
  FontSize->16,ExpressionUUID->"7eb5753a-10aa-45ff-b0a3-2d142f799f25"],
 StyleBox["\n      ",
  FontFamily->"Times New Roman",
  FontSize->16],
 StyleBox["Element Stiffness       Boundary Conditions        External \
effects",
  FontFamily->"Times New Roman"],
 "\n\n",
 Cell[BoxData[{
  FormBox[
   StyleBox[
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["\[PartialD]", "2"], 
       RowBox[{"\[Psi]", "(", "z", ")"}]}], 
      RowBox[{"\[PartialD]", 
       SuperscriptBox["z", "2"]}]], " ", "=", " ", 
     RowBox[{
      SuperscriptBox["\[Kappa]", "2"], " ", 
      RowBox[{"sinh", "[", 
       RowBox[{"\[Psi]", "(", "z", ")"}], "]"}]}]}],
    FontFamily->"Times New Roman",
    FontSize->16], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   StyleBox[
    RowBox[{" ", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["\[PartialD]", "2"], 
        RowBox[{"\[Psi]", "(", "z", ")"}]}], 
       RowBox[{"\[PartialD]", 
        SuperscriptBox["z", "2"]}]], " ", "=", " ", 
      RowBox[{
       SuperscriptBox["\[Kappa]", "2"], 
       RowBox[{"\[Psi]", "(", "z", ")"}]}]}]}],
    FontFamily->"Times New Roman",
    FontSize->16], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   StyleBox[
    RowBox[{
     RowBox[{"\[Psi]", "(", "z", ")"}], " ", "=", " ", 
     RowBox[{"\[Psi]0", " ", 
      RowBox[{"exp", "(", 
       RowBox[{
        RowBox[{"-", "\[Kappa]"}], " ", "z"}], ")"}]}]}],
    FontFamily->"Times New Roman",
    FontSize->16], TraditionalForm]}],
  FontSize->18,ExpressionUUID->"8848e6be-b485-4a91-b500-018d7c7ae653"],
 "\n\n",
 StyleBox["T(z) = ",
  FontSize->18],
 Cell[BoxData[
  FormBox[
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "M"], 
    RowBox[{
     RowBox[{
      SubscriptBox["N", "i"], "(", "z", ")"}], 
     SubscriptBox["\[Psi]", "i"]}]}], TraditionalForm]],
  FontSize->18,ExpressionUUID->"a385e810-bc7f-4531-b444-f97f515d648e"],
 StyleBox["\n",
  FontSize->18],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["\[PartialD]", "2"], 
       RowBox[{"T", "(", "z", ")"}]}], 
      RowBox[{"\[PartialD]", 
       SuperscriptBox["z", "2"]}]], "-", " ", 
     RowBox[{
      SuperscriptBox["\[Kappa]", "2"], 
      RowBox[{"T", "(", "z", ")"}]}]}], " ", "=", " ", 
    RowBox[{"err", "(", "z", ")"}]}], TraditionalForm]],
  FontSize->18,ExpressionUUID->"ba8b8809-d95a-44e2-a80a-018a7b7ede3f"],
 "\n\n",
 StyleBox["Least squared FEM (Galerkin Method)\n",
  FontSize->18],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["\[PartialD]", 
      RowBox[{"\[PartialD]", 
       SubscriptBox["\[Alpha]", "i"]}]], 
     RowBox[{"(", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"j", "=", "1"}], "M"], 
       SubsuperscriptBox["err", "j", "2"]}], ")"}]}], " ", "=", " ", "0"}], 
   TraditionalForm]],
  FontSize->18,ExpressionUUID->"f7e8fd38-a3ea-49f1-8d66-9728fc6af6b9"],
 StyleBox["\n",
  FontSize->18],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["\[PartialD]", 
      RowBox[{"\[PartialD]", 
       SubscriptBox["\[Alpha]", "i"]}]], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Integral]", "D"], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"err", "(", "x", ")"}], "2"], 
        RowBox[{"\[DifferentialD]", "D"}]}]}], ")"}]}], " ", "=", " ", "0"}], 
   TraditionalForm]],
  FontSize->18,ExpressionUUID->"1563b928-15dc-420f-b779-c0081b12951e"],
 StyleBox["\n",
  FontSize->18],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Integral]", "D"], 
     RowBox[{
      RowBox[{"err", "(", "x", ")"}], 
      SubscriptBox["W", "i"], 
      RowBox[{"\[DifferentialD]", "D"}]}]}], "=", "0"}], TraditionalForm]],
  FontSize->18,ExpressionUUID->"d7132ba3-110a-4e1f-b2c3-2c36b21bc354"],
 "\n\n",
 StyleBox["Let ",
  FontSize->18],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["W", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["N", "i"], "(", "z", ")"}]}], TraditionalForm]],
  FontSize->18,ExpressionUUID->"eeb56544-cfd2-4488-8e3f-d9f9bf32d99a"],
 StyleBox["\n",
  FontSize->18],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Integral]", "D"], 
     RowBox[{
      RowBox[{"err", "(", "x", ")"}], 
      SubscriptBox["W", "i"], 
      RowBox[{"\[DifferentialD]", "D"}]}]}], "=", " ", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      SubscriptBox["z", "1"], 
      SubscriptBox["z", "M"]], 
     RowBox[{
      RowBox[{"[", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["\[PartialD]", "2"], 
          RowBox[{"T", "(", "z", ")"}]}], 
         RowBox[{"\[PartialD]", 
          SuperscriptBox["z", "2"]}]], "-", " ", 
        RowBox[{
         SuperscriptBox["\[Kappa]", "2"], 
         RowBox[{"T", "(", "z", ")"}]}]}], " ", "]"}], 
      RowBox[{
       SubscriptBox["N", "i"], "(", "z", ")"}], 
      RowBox[{"\[DifferentialD]", "z", " "}]}]}]}], TraditionalForm]],
  FontSize->18,ExpressionUUID->"613ae2a2-a385-43bd-9f1d-2efdc89a1680"],
 StyleBox["= 0\n\nbasis function ",
  FontSize->18],
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{
     SubscriptBox["N", "i"], "(", "z", ")"}],
    FontSize->16], TraditionalForm]],ExpressionUUID->
  "20e12b96-6316-444c-8540-c8e87f6f140f"],
 StyleBox[":\n",
  FontSize->18],
 Cell[BoxData[
  GraphicsBox[
   TagBox[RasterBox[CompressedData["
1:eJzt3U2uLDlWAOASMGDIFtgFsxJDpo1YQLcoWkwKqRsJMXqrYD0lsbGisgvr
ufwc/47wseP7pKz76t68NyPDDv+dE86//8N//O7f/uq7777789/+8p/f/f6/
/vFPf/r9f//z3/3yP//y45///Y8//vCv//Tjf/7wxx/+9A9/+Otfvvm/vzz+
55d//M0vX38GAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAICX+PLly18eAAAAcNT333//83fffWdeCQAAwCGf
uWT+MK8EAABgj59++ukv88hPnPIzl0z/BgAAxuJ+NnpI88j0+EhfAQCAMeTj
evNKnpLqXVrPSI90b+UnhgkAAMSXxvDyDnlKmfNaPtRFAAAYQx6fzOOVcKcy
57Wsf+ohAADEV+Yelt+Du6Q4Zaprecwyxc3FKQEAILYyRmQ8Tw9lbFKMEgAA
4qt9JmAenzSu50n2HQYAgLHUYpTlHinmlDwl1TkAAGAMS/mG8g/pIeVdAwAA
46jFJe3RQw9yXwEAYGxikvQk9xUAAMZmPE9Pcl8BAGBs5pT0JPcVAADGZk5J
T+KUAAAwNvvy0JM4JQAAjE2ckp7EKQEAYGzmlPQkTgkAAGMzp6Qnc0oAABib
+ynpyZwSAADGJk5JT+aUAAAwNnNKerJHDwAAjE3uKz2JUwIAwNjEKelJnBIA
AMZmTklP4pQA/ezNVTJWAGazp137tI/av32cJ3qafU75icGW7698zz/99JPr
kDCW+s+yHn+eI8dgfJ9yzMs7tUdlHXCfDDCbsq1L/V/e1tW+R52xLD3Nnvv6
eW+fa+wzTvtIbVPtexBBrf9MdTZ9L8079LHjWxpT1b4HMJM0Riv/v/Y91omP
0Nvscco943PjNSIp62w+xyi/N/O1+yZ5+5PKOh9X1eKWABGU61/pa/7v/Guu
HH+lfi3v37R/+zlP9DT7nLKM56R8wXJ8PvM5YDy1+eOn3qacAusgsXzamdSO
7H3kyvljyh/JvzdzPgkwnny988ij9jfyMdrS9/YcSyujzmNHPGbmEX0+VbZZ
W21YTW2962h7BUcd6W/X5hh5/ypuFVPLcZWYNDCCWnv1cbRvqvWHZXu49/f3
HvNWezpqHzviMTOPyHPKM+O0tdyK/N7KFAdIX9O9leXv1b4PW/J9VtIj1b8U
byzrZCn1Dflz8jqr74gjb2NSG3Sk7SjbqNr3yrYt1QOAHlKftNSH7ZW3nalN
y7+31teVfeneeKY5JbQ3wpyy1d8q26a1uajYAFddrb+1uNZWXL51/g/7HVkr
X/r9tTZq6fUAemrV16V/59/bGoeVa3BbzCnhPpHXulvPKcu/VxvDJXmMAM5I
dejs+m1tjXZr3fbqnNKc9Jqza/Z5XDtvc7bWDyKueaXjkuMB75DnqJ697tfa
v6V2Ln9+ipnuPdYZ55T2faW3pXz4CFoeUy0vP8+ZWHp+tHPCWK5cW7U6u/f+
krPMKa87Wz61NYitdihS+1TL9zavhHfIr/8z7VJtPW5rja7Mj117XnkPylbO
z0hzynQ/10jHzJzSmvLVvK3W7pjTLbUbT70+79QiH3Lrey1FaAMitklHPNF2
RDo3a3nawHs8GaPIc8228mOX5pFL+R4jtV+j95fMI+W+5nUyQr5n7zld79dn
Hk/WpVlyX8u15HzvmxGUn2F0lwhtVH6fQBqflWuVvY8ReEZq+5b2PmzpTE7E
3r18Rpiflbkh9u6jt3yNJtJaR+85Xe/XZy5PXVMt5oRRrv3aY6Tr8Yky791W
l/PG8mukPgV4zpO5Gkfalr19yQhtVi3mGv2YmVsZ948Sr+w9p+v9+sznqT5q
qd7m67NL13jPPqlcc4241nVEHr+7S4Q2soxPrsUrI+TAAPe7O1ejXM96U5yy
7BPz9xL1mHmHck6Zvtc7NtB7vcWcktaeqlNLfeFS/K/2+z2s5UrmPxvJ3ccc
qazK95qvX+Q/H60MgXPu6POWclj2vs7esWXUtmprjTXiMfMetTll+v6ZXPVW
eueFm1Nyh6fyIc/W2x5rOeWedbNdcy0+E3xJj/OV9wv555MvxSlr807xSphf
3ra3aKfyv5Xa0/QarceMEeeUe8bl0Y6Zd9na++JsfkGL4zKnZEafuh01H/Lp
OWWZF3nkuNOcJfrnVeQ5va09Oe7Jx215Hcv35Mjnkqme155rXgnvsfa5bUc9
2d5HGv/lbe/aOTCnpKc948+tWPtdx2VOyYzunrdd+dtPz1GutCtbObzR3HGc
T733sqzydrH2s/xrrR0dqdyA61zz56y1vTXOLz0t5b7WnvdkLmzvtuepzwLg
ne7Ohzx77TwZp7y6dl3u6RM9XpnObcv43BPtZBlbLNvEPE5ZzvOXYs9l2QHz
27s/Dr86Op/80J7S0945ZfJUbMB1wczujINfvTafvPZavNbRPren1u3mE3Oy
o+39meeOUHbAddaR9jmTx/P0vStQOnoP0xOxgfQaMLO75pVv67OXPoMkqhb3
09b2v2ltKz655Gj9q92jCcwrtYGu97pyn4Ej3tT3E8/ROGVy5xjOWgtv0Xr+
l/dFb7N2/14kLdq3p3JFzrzGld+JXnZAG2/tp/a40r47p/R0dq3oztiAOSVv
0fIeu8j3p915/2jy+dtlzCvqPZZXz0daC7zj/V2NG56tg3v3NQTGl9+Hza+u
toFy/OjtbJwyuWOvhS//vw89vEHLHMZoY/EeealX95N9wp2fL3JWq7K68r7K
WHO0+gy0ZR2pbT8ZqU/hfa7OKdPfaDmGa3FMMJJZY/N5u/Dk+xslBzjSMbYq
p6t/Y5QcZqCNSO3g01r2kbOOIxhHq/ukz+x5vPa3jCV4k5Y5sFH0zmUcoR2J
Uu4ty6rF2Khct+99foD7jLIG2Fr5+Ust+sm3nUNiabkW3GpeaX2aN5qlTx0h
9zSSnufqjphgy/fSK84NPOvufayjuaPtFaektzvW8lvs8fCWdgVyLT5noqdy
PhnpHpnPsUSNXT6xh1Ep3bfeOg7Ycv4nXgnv8ZZ55Z35/eaU9HTXGOvK2rJr
grcaeZ2xZf77HaLHT588rjvPxR1/0z2W8A4j94F73NlHzn7uiO/Oz53N45VH
1pejxTfgSVHnPFvy6z2i6DGvNB64u+3L52d3nIM760DkNQGgjYh5Llc91f9o
G+npzjnlx55cuPJaS9db1Dw1uNPIn9v1ZYDPf7hjX4RW0rHdofb5nXe4c873
1HsA+popD/bJHBlzSnp6at62dj2VP0vHZD2at1L37xc15nXXMT3Vpj75GrOM
OYFvzTCvfHI+KfeV3u6OUyZrcf+83SgfEcd88IQe+7bslfa7GVnLz5luqXWc
On+fT7T3T7XZ7rGE+Y08BuzRRo16rpjD0/mltTFcPqfMv6bnwxtFXqOdaSwf
cV7Zchz1dDy2x2tFKjugrRGv8fJ+ridfF3rpcc9ibe0mj1OmtfRR7ymDVqLN
K6PG9q7I79GL1N4sxan3xq3Lsnoq3v10vRCvhLnlbdkI8nu+n84zGuUcMade
++AszSuTkdoPuFOka6HX2usTos1JltYT9h5nr3lWr7oxY50EvhrhGu+95hr9
/DC3p+6nXHrt/NrL76GMFC+AniLsAztjfHIE+dpbuV/tnt9509xOvBLmlvqh
iNd32Vb3OkZzSnrqWfc/Uq5rmfsKfJX6qx779ZR95dv03CMpj1Xmn6+0NG7o
mXOV9Iwl9Mr3BZ4RYY21VMZHerU76dxAL71yX8tjyMchvY8HIlqbS9xp1lzX
PXqd8/y1l/YyK0Upp0jH0Ps4gHtEub6j5UdEOCe8V+84Zc5nWcOyp/N+nv4M
ioh6xrzy85/fG1CbU0aITyYRxnrilTC33vHK9Hla0frH3m0v7xYhTpmzvgzL
nr423n4tRrk3sczjKP8daS0uUp0pc2CAuURomyO0u4m2jp4ira8kkdbcIZLe
a7Nv1Dvmlccmy5hl/hkoUdrxSHM4sXaY29P7OvbuD9a4n5Leoq2xJLX1eSDW
mP1NerdJtft2ItaFaMfzoS+BeT0VL+zdB+wR9bg4puVaRcrTfkLUOWWeqy4u
A7+V4lOjtjsjKtene/Xdn7LPczmiiX5cUfs84LxyT7O7/n7E+GQiTjmH1mOM
J/u96P2rz8WDb+XXRQvR9q6LrPW5P2KEcoo6p/ywTgnzyj+X7o6/G7nd/TCn
nEPrOeWT+wpEv0YS80r4Vqt2onfsjW2jlFH0Y+y97xJwn9bX9WhtxSjHSd1d
a9ZP1eNR5mjilfCtq+uy4jbxlfcBRG/7Rhh/mVfCvFrcGzJCrmtJnHJ8d/bz
5pTfGmlsBU84205EuDdwFnfeyzNaGY1yrPoSmFfZDh3J/xt5zWm04+W3nphT
3tnfjdifjpLbDk/I5zP550us9S3G023d0SZF3rN+zUif2bH3egHGkl/b5Rxx
rX0qc3dGacs+xCnHd2dfdPc+Vh+jjinFWOCrss9cuy7kkLd3ZMyyl/btOc41
zKcWb1y7zkeOTyajHndUaa3+6O+cWQPeey/l0j1PW3PGJ/YXHHlcOWK+O7RW
xinTo9Zu5G3KqNd9VK3mldq155Vxe+ccxpfijPkjjcdLeZs78t4C5pRtLfXn
Z+d1a/b+bi0vam9utznltvz8GgvwJqnup74z70PX1mJHv+YjuzInlNffl/MP
cyjX95bmlPk668hzycScsq2led5SPHur/9hzT9Ie5evvnY+aU+4zer4CnFHL
1dm7XsV9zuRQacNikBsOc1jKe83b2Jna3SNzEvZZGk+lNYiyn1hbS97qV46U
X5lbsxR/XzqGu8zUb1pj5o3y9iRfk00xS7H7PvIy2YpXzpBrkerbDO3vDOUB
b1d+DlNqm/Kvs8QnP+zRc4+lOWWtv1ubs7WcU6bnH/29u9dQZuj/c/n5cm3x
JnvWZHnWnpjXLHGx2dremd4L8Nvx7qzX92zvJ4Kyf07rEPk9Rx979sBZW6M8
uiabP3/vuog45XEzrj/BHmldNr+nUh/T19L9q7X48sjKmMAMyvwiYGwztbkl
ccr71PKly39fzdM5E6fMc9Oi5L7O6Mz9TDADdX8Ms8QnS7PVO9cSzGHWNjen
nbpHqjNp3v5Zm0jrqPl9RntyW7d+fiSPNb3+0j60OZ8lck0Zr3RfDLMrY1/E
k/c7M5bRjH2K3BcYVz6WnrF9SsQp75PP2fJ+oMw//fx7aa6xVf/yero1X8nr
c5kjdHZO28KeYx/Z3nMNI1PPx1DGkNP65kxmrX/luHTmfhNm8bZ11je8xx7y
NeCyj6vlwdbsGZ/tec5SPHMrp+aJ8eGs/X/JeJuZqd/xlfPJWdfNZx+7yYWF
MbytX5w19yWCsv8u55R71oj31MX8M8e3/k7tOUuvkR//neuhb1pvnfnebN6t
zMcglqW+aLY26Yncmt5m+4x0mFGZD/IW5pT32ZpTtohT7rmncu3vnI1htjJ7
/19jnRl4ylZ/s7c/GsEs72OPN71XGMlMbepRb3u/T1paM8337Vmzd41ja+6Z
7nVaO848VvjE3jzJm+KUSRkbeNv7B+639/678n6f0dfU37JO+SnPPE/pDe8Z
InPPszlldHv6xzvWQ57ql9/S/9e8dR2L8b31mh3J0fZllvZo9OM/atb7YmE0
s7ShZ7mfMrYj94Z8Wfhc6yuv/YQ394Pui2E0e3Lt6S+POx5ZK08xy1G9tX7O
dl8sjKTcP+WN8cnkbW3vaGafb+gDf54q74x55f2mehrT28vozXGCt5c99HB2
/W5GPp8ytjf0jzO/tyPefE838amfY1BG83+WyBbxSniGfvFbzkNss685Wtv5
yjozEamX8d2Z+7jn86oieftc6m2fiQc9yDf/ljhlfLPX19nf31FlXj70ZP+P
+O5eK9cmjUmZQXvaw3XOSUxvWQOZ/f2dUcaFxHHpwWfexPdEP1Huj69NGoN9
Q6Ctsi00dv0t+77G9ZZ1ENdlnbUwetJvxvd0jqM6MSb9CLThWtrm3MT0WQ95
Q2zA+uk6e4rxNOsZsaW+IcUMn5rf5a+rTRqHz2GHa+wpsI/7KelNH7ftLXnQ
xPGG9awRRZjTRc//inhMEehH4JjobV00cl/pzXW6j3YN3i1S/Lg8lkhtUoTz
E1XUMoOIorS3I3Gu6Emccr98ndl5oxUxyfii5l5FPSbzpWXilbAuQj7IiOS+
0pv6d8zdnxvAu+R9JzFFik+OwHnapj7BMtfHOXJf6c0a0HF5jv+Te3Qwj3K/
lUhxJr4qr3W2ib/tI14Jv1XupW1seow5Jb3pz86zlsZZYl/xjVo+vY95tPPV
kzwF+JU+8TpzSnoTpzzPnmScIT4Z38gxpN51a8Rz1pP2gLdzDbRhTklv6t91
5pXs5X7c+Ea/nnvvCatuHydGw1vpE9sxp6Q3cco2Ro5r8Iy8jliLjWmG67jM
n3j6vRjTnCNWw5uUewqM2t5GYt9XejOnbMdaM0tGj33NrpyHzdAmlu/pqXmK
On6ePaF4A/X8HuKU9Kb+tWVeSUmdiG328nlyPWPWc/g0e/cws5nb296cU3pS
/9rzeb2U7Ise0xv2rq/lmN35PsUpr/uUT8rD9nlVzEKu673EKelN/buPtTiI
623jm6fildq7duTMMwt78dzPnJLe1L/7zHiPFszgjfuhpHjlnXMTY5r2Ztg3
indTh5+h/aU39e9+1ufeRb8Z2+z3T/bmnLYnXsmo1N3nmFPSm/p3v177L/Ks
N8a+RuI6vF+6Bowd2xPrYSTl3q7q7P18lgi9qX/PsX/2vOzLFJs9T5a1bJOs
k9/rbfcAMya5IH2YU9Kb+vc8be1c5PbEp4yWtc7N17bdy7ySyNTPfqzp0Zv6
97wyB0+7O64yH018Mha5Afvk9fjKeTKmeYY4EBEZ1/Sl/aU39a+Pckyg/R2P
9dj4jLv3axWvdK6fo34Thb0I+zOnpDf3fvVl34Xx1D5DnljEcY4r6/WZeKU9
ep7l86roTR2Mw5yS3tS//sQrx2I+GZv18muu5lA4589T3+nB2l0s5pT0pv7F
IF45jrQu6/68+x29Ftzf2sbZsaIxTR9lrAiOSm3nXvY6j0f7S2/qXxza6Gel
XD/nOaYj4+NPOebzSWV6XZ4Le+R86lP6ObI2afwZ29nPPErX7VFH21tr4PG4
pulNmxDPkfVm69LXqP9xHanbYjRxKIO+9saYXS+xnS2fO3/P3oKxmVPSk/oX
05F73mcYF/R6D+k8r/WL4pj9nBnjKKv71a6XdJ3kY8304Fll/7GUo6//j+to
HmpyZY+srfbWfDI+1zS9qX9xjbTWfPYYeh7/nv43yvl9K2OcWPJzXvve0oPn
bcUrlU1cd80Lz/6uvXjGYE5Jb+pfXHv29o/Qxp9dG+29183acW+dd+631j8q
nz5qceEUU0n3f6VH+r65fj9r14nxZ0xn+/Qz9z7ved087q2tjc01TW/6/PjW
YjER5pRX79/oWf/WzmmEc/tmS+dffLKv8vpYWpsxvolhaT8V7Vs8Z9dna/kD
R9V+X184Fm0uval/Y1gaF5y976L1cZ2NUfacD9SOPd838cqaL9fV+kfxyRhS
OeSxyfTv9LX39c1Xtf5DGcWT+p+j/c7Z38uV88a8L9TWjsGckp7Uv7HUclB6
rx+eHZN8jr93P5WPqY7si8Qz8vapLB/j4Bjy/NbyoW+JpZanrIziONu2tVob
yOel+RqEvnAcrml6Mz4bT5R8lCuvH6HelTmUvc8nv5WXx1Kcnv5qcS/lFFe6
prR3cfTMeU1qOe3pNbjH1rnNy3XpuXn5u6bpTf0bT5ln1qMM89y3o6Lk0uT5
t/mDGPL6neq7NfPrWtfxfDycl9lSWeWvXx5L+v/yd8v82vxRy7ktv1fm49bq
Vu17KZ+i9rfyn9WOZWnPoqX3UB7b3uMt/07t76e/U+b25/OHPY/a3z7znJEf
tfPX6nE259XDI39AL5/698U4ekg925Czr5v65Ah1Lh8fpH/zVe9+0cPDwyPa
46zU55V935W/nf/e52utT6v9f94P57+ff82fs/W88vnp/2vfq/1e/rV8P+Vz
lp6/9npLr5s/t3YsuXKMUHtu73GNcQy9Wedq+yjva9/6We1rba08///aeumV
ddczj7wv26s85miPM8e3VMZ5OdbKq/x+/tyl2Er5Wlvfy3+/fI9L9W9vXa69
l6V6u/X3a8e7VvfXro+l39v6Wfm6+Xkv/127DsvrY89zlh7lceW/X9aRrded
5QEzOvt5Wvn95QCRpD47Hx/m339SaiPL187/f8/Pal/zf5fvs/a98vfyY1ub
K7zlcaZsy9/L/792ztd+tlSO+d9eK+OyPPNx+9L/z/5YKicA2ir7pLt/DwCe
ttRXpfnG0fs+zq7HAsCMrq7Pur8cgBFdWRsV+wKAX6Uc/KNSPwwAo2qZ8woA
b3VlfVbOKwCjunrfh5xXAN7uyv46qT+V8wrAqMQoAeCaq+uz+lMARnX2vo+0
HitPBwC+9otHY42pHxajBGBUZ+eF9hIAgOvEKAEY2ZX7N8QoAeA68UkARmZ/
HQCYh/kpAACwpZYjIm/kfWo5s/JoY6uVjTIjgk8fUq5Jfb6nb4npU1ZleX3+
X3kxizL2nfasEA8fR23/LXtyxZLGoHl/Ylz6PmU9SP/vOo2r7A+VGVGUfYj9
qGOr7WujPWEmZX0+u7c+/dT6EeUYS1ke+v53yss9fxBXOQ5UZkRR9itpP2r9
fkzl5yEbpzGbvE7n4x33+Iwlld2nT1GOMZXzCLkA75Rfq0fHE67nPlJZHY0p
lGNIaC1f8/D5DvHV1hVhJnk7pH6Pq1wXIB7XGR9n64E17T7ytde9ZVaOHVsf
CyTmJ2M5u6YIozjSX7oGYsrvoVyLgZ39nHeuy2NUW1rHMu3dEMenXNOYYo88
3qUMn5e3rXvLLC/jvb+z57ny5Sjl+Ulb1Jv+8jWAtXFY3u7Lb2IkeX+51ua0
Xg9Lfa75zXWfc7inb7EPUz97r7MjZbR33zjr2DGUMa+tMi7jXdrK56V+Kv+6
JpXZkb3S9ubJmlNSOpL3oA/o7+h4W74sIzlaX1v2ZfJ42rkr14o27tqbZW/8
Sr2IoTZO2PN85ddPfu73lll+L8LePtOckqNSPDzlJ62tO6k7/eU5r2t999LP
5MwSXb7uuncdtpUj+V+sS+W2p2/hWbUYxNb48Uvls8dq9l5D5iT9leOBfFxR
K+s8lmkc0Uc5Dt8qs4+9ZZbmnXmbndrw/LF2PLzbUt1cez79LI0Dyut56Rp3
/RNdWT+31sRbxhbFKdso26WtvkWb9KxaP7DVN+ydA+7tY8wp+6uNH9bKL/+Z
suujdt3svXaPxqCXHkdem/dYqx/6/nhq7fjRe5GsLxLZmTYp/bxFDEw87bql
+3D25FXwjFosceteq61rMP1efg2leytr15My72/p3telMtvKj+J+tbJZu87y
9nhPv7YVp6w9X33gY6lNX1uD0gf0s1QuR3Le9eNEt9RvrT1/baxb80TM883W
4hxLz3feY9saLxyJbaz9PeLak8tGPGfLbM9c0ZySK9Sd8VhbZGZba2BLj1ps
35yyD+PU+JbKKMVI0iO/vtbiG8p8PE/f3851R+OU5e+ZU3IndWccZ9sSGMla
7mv6XsrDS/9easPkvvZhfhHf0fspt64hZT4ee5iNJZ/vpf0499p7X5U5JVdo
T8YhNskbtIwtilP2YX4R39E55Va/o8zH4t6Z8ZTldUf5mVNyhbozBtc5b7E3
LrKHOGUfxqrx7S2jvdeQMh9HKlN5T2PI99jJyyr1lXleeovXMtbkLP3AOJQT
b9CyT9O+9eG8xydO+U5l7sbW3kv0tbWPUl52reaB5pScpe6MYWsPPvfYM4uW
ccqWf4v9jE/j2zsO3XvtpFgJMaX7zmvtob164lr7XBGIRt8/jq15Jcygde6N
a+N52qT4lNG72I8BuJu1DyAS93OMLd+fmph8HhUAADPKx7nmI2OSjx9fPudX
RgAAzGRrLwLGoPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAOCr/wPJYDAP
     "], {{0, 194}, {917, 0}}, {0, 255},
     ColorFunction->RGBColor],
    BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
    Selectable->False],
   BaseStyle->"ImageGraphics",
   ImageSize->Automatic,
   ImageSizeRaw->{917, 194},
   PlotRange->{{0, 917}, {0, 194}}]], "Input",ExpressionUUID->
  "46f2d162-41f6-43c1-a381-5064d3f11c58"],
 "\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     SubscriptBox["z", "1"], 
     SubscriptBox["z", "M"]], 
    RowBox[{
     RowBox[{"[", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[PartialD]", "2"], 
        RowBox[{"T", "(", "z", ")"}]}], 
       RowBox[{"\[PartialD]", 
        SuperscriptBox["z", "2"]}]], "]"}], 
     RowBox[{
      SubscriptBox["N", "i"], "(", "z", ")"}], 
     RowBox[{"\[DifferentialD]", "z", " "}]}]}], TraditionalForm]],
  ExpressionUUID->"ee55805f-4a23-46c1-8f31-196b96a98e50"],
 "= ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     SubscriptBox["z", "1"], 
     SubscriptBox["z", "M"]], 
    RowBox[{
     RowBox[{"[", " ", 
      RowBox[{
       SuperscriptBox["\[Kappa]", "2"], 
       RowBox[{"T", "(", "z", ")"}]}], " ", "]"}], 
     RowBox[{
      SubscriptBox["N", "i"], "(", "z", ")"}], 
     RowBox[{"\[DifferentialD]", "z", " "}]}]}], TraditionalForm]],
  ExpressionUUID->"b9e4f0cf-6c60-4d0c-9890-ff2f0886d973"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"\[PartialD]", "T"}], 
       RowBox[{"(", "z", ")"}]}], 
      RowBox[{"\[PartialD]", "z"}]], " ", 
     RowBox[{
      SubscriptBox["N", "i"], "(", "z", ")"}]}], 
    SubsuperscriptBox["\[VerticalSeparator]", 
     SubscriptBox["z", "1"], 
     SubscriptBox["z", "M"]], " ", 
    RowBox[{"-", " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       SubscriptBox["z", "1"], 
       SubscriptBox["z", "M"]], 
      RowBox[{
       FractionBox[
        RowBox[{"\[PartialD]", 
         RowBox[{"T", "(", "z", ")"}]}], 
        RowBox[{"\[PartialD]", "z"}]], 
       FractionBox[
        RowBox[{"\[PartialD]", 
         RowBox[{
          SubscriptBox["N", "i"], "(", "z", ")"}]}], 
        RowBox[{"\[PartialD]", "z"}]], 
       RowBox[{"\[DifferentialD]", "z", " "}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"d567b4d8-4ab9-4258-9489-0b4479d60ef7"],
 " (LHS: integration by parts)\nLook at the first term\ni=1, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["N", "1"], "(", "z", ")"}], 
      FractionBox[
       RowBox[{"\[PartialD]", "T"}], 
       RowBox[{"\[PartialD]", "z"}]]}], 
     SubsuperscriptBox["\[VerticalSeparator]", 
      SubscriptBox["z", "1"], 
      SubscriptBox["z", "M"]]}], "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["N", "1"], "(", 
        SubscriptBox["z", "M"], ")"}], 
       FractionBox[
        RowBox[{"\[PartialD]", "T"}], 
        RowBox[{"\[PartialD]", "z"}]]}], " ", "-", " ", 
      RowBox[{
       RowBox[{
        SubscriptBox["N", "1"], "(", 
        SubscriptBox["z", "1"], ")"}], 
       FractionBox[
        RowBox[{"\[PartialD]", "T"}], 
        RowBox[{"\[PartialD]", "z"}]]}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[PartialD]", "T"}], 
        RowBox[{"\[PartialD]", "z"}]]}], 
      SubscriptBox["|", 
       SubscriptBox["z", "1"]]}]}]}], TraditionalForm]],ExpressionUUID->
  "925847cc-6168-4ef1-ac9b-c8d601319865"],
 "\ni=2, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["N", "2"], "(", "z", ")"}], 
      FractionBox[
       RowBox[{"\[PartialD]", "T"}], 
       RowBox[{"\[PartialD]", "z"}]]}], 
     SubsuperscriptBox["\[VerticalSeparator]", 
      SubscriptBox["z", "1"], 
      SubscriptBox["z", "M"]]}], "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["N", "2"], "(", 
        SubscriptBox["z", "M"], ")"}], 
       FractionBox[
        RowBox[{"\[PartialD]", "T"}], 
        RowBox[{"\[PartialD]", "z"}]]}], " ", "-", " ", 
      RowBox[{
       RowBox[{
        SubscriptBox["N", "2"], "(", 
        SubscriptBox["z", "1"], ")"}], 
       FractionBox[
        RowBox[{"\[PartialD]", "T"}], 
        RowBox[{"\[PartialD]", "z"}]]}]}], " ", "=", " ", "0"}]}], 
   TraditionalForm]],ExpressionUUID->"937ff1f7-af17-4544-9bc6-53b4de77824a"],
 "\ni=M, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["N", "M"], "(", "z", ")"}], 
      FractionBox[
       RowBox[{"\[PartialD]", "T"}], 
       RowBox[{"\[PartialD]", "z"}]]}], 
     SubsuperscriptBox["\[VerticalSeparator]", 
      SubscriptBox["z", "1"], 
      SubscriptBox["z", "M"]]}], "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["N", "M"], "(", 
        SubscriptBox["z", "M"], ")"}], 
       FractionBox[
        RowBox[{"\[PartialD]", "T"}], 
        RowBox[{"\[PartialD]", "z"}]]}], " ", "-", " ", 
      RowBox[{
       RowBox[{
        SubscriptBox["N", "M"], "(", 
        SubscriptBox["z", "1"], ")"}], 
       FractionBox[
        RowBox[{"\[PartialD]", "T"}], 
        RowBox[{"\[PartialD]", "z"}]]}]}], " ", "=", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"\[PartialD]", "T"}], 
       RowBox[{"\[PartialD]", "z"}]], 
      SubscriptBox["|", 
       SubscriptBox["z", "M"]]}]}]}], TraditionalForm]],ExpressionUUID->
  "1097f1ce-ee38-458f-b698-2dd2cd81ce0d"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SubsuperscriptBox["\[Integral]", 
           SubscriptBox["z", "1"], 
           SubscriptBox["z", "M"]], 
          RowBox[{
           FractionBox[
            RowBox[{"\[PartialD]", 
             RowBox[{"T", "(", "z", ")"}]}], 
            RowBox[{"\[PartialD]", "z"}]], 
           FractionBox[
            RowBox[{"\[PartialD]", 
             RowBox[{
              SubscriptBox["N", "1"], "(", "z", ")"}]}], 
            RowBox[{"\[PartialD]", "z"}]], 
           RowBox[{"\[DifferentialD]", "z"}]}]}], " ", "+", " ", 
         RowBox[{
          SubsuperscriptBox["\[Integral]", 
           SubscriptBox["z", "1"], 
           SubscriptBox["z", "M"]], 
          RowBox[{
           RowBox[{"[", " ", 
            RowBox[{
             SuperscriptBox["\[Kappa]", "2"], 
             RowBox[{"T", "(", "z", ")"}]}], " ", "]"}], 
           RowBox[{
            SubscriptBox["N", "1"], "(", "z", ")"}], 
           RowBox[{"\[DifferentialD]", "z", "  "}]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SubsuperscriptBox["\[Integral]", 
           SubscriptBox["z", "1"], 
           SubscriptBox["z", "M"]], 
          RowBox[{
           FractionBox[
            RowBox[{"\[PartialD]", 
             RowBox[{"T", "(", "z", ")"}]}], 
            RowBox[{"\[PartialD]", "z"}]], 
           FractionBox[
            RowBox[{"\[PartialD]", 
             RowBox[{
              SubscriptBox["N", "2"], "(", "z", ")"}]}], 
            RowBox[{"\[PartialD]", "z"}]], 
           RowBox[{"\[DifferentialD]", "z"}]}]}], "  ", "+", " ", 
         RowBox[{
          SubsuperscriptBox["\[Integral]", 
           SubscriptBox["z", "1"], 
           SubscriptBox["z", "M"]], 
          RowBox[{
           RowBox[{"[", " ", 
            RowBox[{
             SuperscriptBox["\[Kappa]", "2"], 
             RowBox[{"T", "(", "z", ")"}]}], " ", "]"}], 
           RowBox[{
            SubscriptBox["N", "2"], "(", "z", ")"}], 
           RowBox[{"\[DifferentialD]", "z"}]}]}]}]},
       {":"},
       {":"},
       {
        RowBox[{
         RowBox[{
          SubsuperscriptBox["\[Integral]", 
           SubscriptBox["z", "1"], 
           SubscriptBox["z", "M"]], 
          RowBox[{
           FractionBox[
            RowBox[{"\[PartialD]", 
             RowBox[{"T", "(", "z", ")"}]}], 
            RowBox[{"\[PartialD]", "z"}]], 
           FractionBox[
            RowBox[{"\[PartialD]", 
             RowBox[{
              SubscriptBox["N", "M"], "(", "z", ")"}]}], 
            RowBox[{"\[PartialD]", "z"}]], 
           RowBox[{"\[DifferentialD]", "z"}]}]}], "  ", "+", " ", 
         RowBox[{
          SubsuperscriptBox["\[Integral]", 
           SubscriptBox["z", "1"], 
           SubscriptBox["z", "M"]], 
          RowBox[{
           RowBox[{"[", " ", 
            RowBox[{
             SuperscriptBox["\[Kappa]", "2"], 
             RowBox[{"T", "(", "z", ")"}]}], " ", "]"}], 
           RowBox[{
            SubscriptBox["N", "M"], "(", "z", ")"}], 
           RowBox[{"\[DifferentialD]", "z"}]}]}]}]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[PartialD]", "T"}], 
           RowBox[{"\[PartialD]", "z"}]]}], 
         RowBox[{"(", 
          SubscriptBox["z", "1"], ")"}], " "}]},
       {"0"},
       {":"},
       {":"},
       {
        RowBox[{
         FractionBox[
          RowBox[{"\[PartialD]", "T"}], 
          RowBox[{"\[PartialD]", "z"}]], 
         RowBox[{"(", 
          SubscriptBox["z", "M"], ")"}], " ", " "}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "b1038449-7c54-4df6-acc2-7065c8a9d791"],
 "\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", " ", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       SubscriptBox["z", "1"], 
       SubscriptBox["z", "M"]], 
      RowBox[{
       FractionBox[
        RowBox[{"\[PartialD]", 
         RowBox[{"T", "(", "z", ")"}]}], 
        RowBox[{"\[PartialD]", "z"}]], 
       FractionBox[
        RowBox[{"\[PartialD]", 
         RowBox[{
          SubscriptBox["N", "1"], "(", "z", ")"}]}], 
        RowBox[{"\[PartialD]", "z"}]], 
       RowBox[{"\[DifferentialD]", "z"}]}]}], "  ", "=", " ", 
     RowBox[{
      RowBox[{
       SubsuperscriptBox["\[Integral]", 
        SubscriptBox["z", "1"], 
        SubscriptBox["z", "2"]], 
       RowBox[{
        FractionBox[
         RowBox[{"\[PartialD]", 
          RowBox[{"T", "(", "z", ")"}]}], 
         RowBox[{"\[PartialD]", "z"}]], " ", 
        RowBox[{"(", 
         RowBox[{"-", 
          FractionBox["1", "\[CapitalDelta]z"]}], ")"}], 
        RowBox[{"\[DifferentialD]", "z"}]}]}], " ", "=", " ", 
      RowBox[{
       FractionBox["1", "\[CapitalDelta]z"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Psi]", "1"], "-", 
         SubscriptBox["\[Psi]", "2"]}], ")"}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"0ffe953b-f417-4c29-be1c-2fda166e4878"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"i", "=", "2"}], ",", " ", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       SubscriptBox["z", "1"], 
       SubscriptBox["z", "M"]], 
      RowBox[{
       FractionBox[
        RowBox[{"\[PartialD]", 
         RowBox[{"T", "(", "z", ")"}]}], 
        RowBox[{"\[PartialD]", "z"}]], 
       FractionBox[
        RowBox[{"\[PartialD]", 
         RowBox[{
          SubscriptBox["N", "2"], "(", "z", ")"}]}], 
        RowBox[{"\[PartialD]", "z"}]], 
       RowBox[{"\[DifferentialD]", "z"}]}]}], "  ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubsuperscriptBox["\[Integral]", 
         SubscriptBox["z", "1"], 
         SubscriptBox["z", "2"]], 
        RowBox[{
         FractionBox[
          RowBox[{"\[PartialD]", 
           RowBox[{"T", "(", "z", ")"}]}], 
          RowBox[{"\[PartialD]", "z"}]], " ", 
         RowBox[{"(", 
          FractionBox["1", "\[CapitalDelta]z"], ")"}], 
         RowBox[{"\[DifferentialD]", "z"}]}]}], "+", 
       RowBox[{
        SubsuperscriptBox["\[Integral]", 
         SubscriptBox["z", "2"], 
         SubscriptBox["z", "3"]], 
        RowBox[{
         FractionBox[
          RowBox[{"\[PartialD]", 
           RowBox[{"T", "(", "z", ")"}]}], 
          RowBox[{"\[PartialD]", "z"}]], " ", 
         RowBox[{"(", 
          RowBox[{"-", 
           FractionBox["1", "\[CapitalDelta]z"]}], ")"}], 
         RowBox[{"\[DifferentialD]", "z"}]}]}]}], " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox["1", "\[CapitalDelta]z"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["T", "2"], "-", 
           SubscriptBox["T", "1"]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "\[CapitalDelta]z"], 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["T", "2"], "-", 
           SubscriptBox["T", "3"]}], ")"}]}]}], " ", "=", " ", 
       RowBox[{
        FractionBox["1", "\[CapitalDelta]z"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", 
           SubscriptBox["\[Psi]", "2"]}], "-", 
          SubscriptBox["\[Psi]", "1"], "-", 
          SubscriptBox["\[Psi]", "3"]}], ")"}]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"43f26758-1b60-4925-994e-16c5cd5c61ed"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"i", "=", "3"}], ",", " ", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       SubscriptBox["z", "1"], 
       SubscriptBox["z", "M"]], 
      RowBox[{
       FractionBox[
        RowBox[{"\[PartialD]", 
         RowBox[{"T", "(", "z", ")"}]}], 
        RowBox[{"\[PartialD]", "z"}]], 
       FractionBox[
        RowBox[{"\[PartialD]", 
         RowBox[{
          SubscriptBox["N", "3"], "(", "z", ")"}]}], 
        RowBox[{"\[PartialD]", "z"}]], 
       RowBox[{"\[DifferentialD]", "z"}]}]}], "  ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubsuperscriptBox["\[Integral]", 
         SubscriptBox["z", "2"], 
         SubscriptBox["z", "3"]], 
        RowBox[{
         FractionBox[
          RowBox[{"\[PartialD]", 
           RowBox[{"T", "(", "z", ")"}]}], 
          RowBox[{"\[PartialD]", "z"}]], " ", 
         RowBox[{"(", 
          FractionBox["1", "\[CapitalDelta]z"], ")"}], 
         RowBox[{"\[DifferentialD]", "z"}]}]}], "+", 
       RowBox[{
        SubsuperscriptBox["\[Integral]", 
         SubscriptBox["z", "3"], 
         SubscriptBox["z", "4"]], 
        RowBox[{
         FractionBox[
          RowBox[{"\[PartialD]", 
           RowBox[{"T", "(", "z", ")"}]}], 
          RowBox[{"\[PartialD]", "z"}]], " ", 
         RowBox[{"(", 
          RowBox[{"-", 
           FractionBox["1", "\[CapitalDelta]z"]}], ")"}], 
         RowBox[{"\[DifferentialD]", "z"}]}]}]}], " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox["1", "\[CapitalDelta]z"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["T", "3"], "-", 
           SubscriptBox["T", "2"]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "\[CapitalDelta]z"], 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["T", "3"], "-", 
           SubscriptBox["T", "4"]}], ")"}]}]}], " ", "=", " ", 
       RowBox[{
        FractionBox["1", "\[CapitalDelta]z"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", 
           SubscriptBox["\[Psi]", "3"]}], "-", 
          SubscriptBox["\[Psi]", "2"], "-", 
          SubscriptBox["\[Psi]", "4"]}], ")"}]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"320de117-0beb-4ba0-ae7c-4d89b4f96628"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"i", "=", "M"}], ",", " ", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       SubscriptBox["z", "1"], 
       SubscriptBox["z", "M"]], 
      RowBox[{
       FractionBox[
        RowBox[{"\[PartialD]", 
         RowBox[{"T", "(", "z", ")"}]}], 
        RowBox[{"\[PartialD]", "z"}]], 
       FractionBox[
        RowBox[{"\[PartialD]", 
         RowBox[{
          SubscriptBox["N", "M"], "(", "z", ")"}]}], 
        RowBox[{"\[PartialD]", "z"}]], 
       RowBox[{"\[DifferentialD]", "z"}]}]}], "  ", "=", " ", 
     RowBox[{
      RowBox[{
       SubsuperscriptBox["\[Integral]", 
        SubscriptBox["z", 
         RowBox[{"M", "-", "1"}]], 
        SubscriptBox["z", "M"]], 
       RowBox[{
        FractionBox[
         RowBox[{"\[PartialD]", 
          RowBox[{"T", "(", "z", ")"}]}], 
         RowBox[{"\[PartialD]", "z"}]], " ", 
        RowBox[{"(", 
         FractionBox["1", "\[CapitalDelta]z"], ")"}], 
        RowBox[{"\[DifferentialD]", "z"}]}]}], " ", "=", " ", 
      RowBox[{
       FractionBox["1", "\[CapitalDelta]z"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Psi]", "M"], "-", 
         SubscriptBox["\[Psi]", 
          RowBox[{"M", "-", "1"}]]}], ")"}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"707afd1a-3d31-4a22-99e8-62028875984a"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SubsuperscriptBox["\[Integral]", 
          SubscriptBox["z", "1"], 
          SubscriptBox["z", "M"]], 
         RowBox[{
          FractionBox[
           RowBox[{"\[PartialD]", 
            RowBox[{"T", "(", "z", ")"}]}], 
           RowBox[{"\[PartialD]", "z"}]], 
          FractionBox[
           RowBox[{"\[PartialD]", 
            RowBox[{
             SubscriptBox["N", "1"], "(", "z", ")"}]}], 
           RowBox[{"\[PartialD]", "z"}]], 
          RowBox[{"\[DifferentialD]", "z", "  "}]}]}]},
       {
        RowBox[{
         SubsuperscriptBox["\[Integral]", 
          SubscriptBox["z", "1"], 
          SubscriptBox["z", "M"]], 
         RowBox[{
          FractionBox[
           RowBox[{"\[PartialD]", 
            RowBox[{"T", "(", "z", ")"}]}], 
           RowBox[{"\[PartialD]", "z"}]], 
          FractionBox[
           RowBox[{"\[PartialD]", 
            RowBox[{
             SubscriptBox["N", "2"], "(", "z", ")"}]}], 
           RowBox[{"\[PartialD]", "z"}]], 
          RowBox[{"\[DifferentialD]", "z", "  "}]}]}]},
       {":"},
       {":"},
       {
        RowBox[{
         SubsuperscriptBox["\[Integral]", 
          SubscriptBox["z", "1"], 
          SubscriptBox["z", "M"]], 
         RowBox[{
          FractionBox[
           RowBox[{"\[PartialD]", 
            RowBox[{"T", "(", "z", ")"}]}], 
           RowBox[{"\[PartialD]", "z"}]], 
          FractionBox[
           RowBox[{"\[PartialD]", 
            RowBox[{
             SubscriptBox["N", "M"], "(", "z", ")"}]}], 
           RowBox[{"\[PartialD]", "z"}]], 
          RowBox[{"\[DifferentialD]", "z", "  "}]}]}]}
      }], ")"}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      FractionBox["1", "\[CapitalDelta]z"], " ", 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           SubscriptBox["\[Psi]", "1"], "-", 
           SubscriptBox["\[Psi]", "2"], "  "}]},
         {
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["\[Psi]", "2"]}], "-", 
           SubscriptBox["\[Psi]", "1"], "-", 
           SubscriptBox["\[Psi]", "3"], " "}]},
         {":"},
         {":"},
         {
          RowBox[{
           SubscriptBox["\[Psi]", "M"], "-", 
           SubscriptBox["\[Psi]", 
            RowBox[{"M", "-", "1"}]], " ", " "}]}
        }], ")"}]}], " ", "=", " ", 
     RowBox[{
      FractionBox["1", "\[CapitalDelta]z"], 
      RowBox[{"(", GridBox[{
         {"1", 
          RowBox[{"-", "1"}], "...", "...", "...", "0"},
         {
          RowBox[{"-", "1"}], "2", 
          RowBox[{"-", "1"}], "...", "...", "0"},
         {"0", 
          RowBox[{"-", "1"}], "2", 
          RowBox[{"-", "1"}], "...", "0"},
         {":", ":", ":", ":", ":", ":"},
         {"0", "...", "...", "0", 
          RowBox[{"-", "1"}], "1"}
        }], ")"}], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           SubscriptBox["\[Psi]", "1"], "  "}]},
         {
          RowBox[{
           SubscriptBox["\[Psi]", "2"], " "}]},
         {":"},
         {":"},
         {
          RowBox[{
           SubscriptBox["\[Psi]", "M"], " "}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "6440620c-33d9-49e5-9869-51510e031aa8"],
 "\n\ni=1, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      SubscriptBox["z", "1"], 
      SubscriptBox["z", "M"]], 
     RowBox[{
      RowBox[{"[", " ", 
       RowBox[{
        SuperscriptBox["\[Kappa]", "2"], 
        RowBox[{"T", "(", "z", ")"}]}], " ", "]"}], 
      RowBox[{
       SubscriptBox["N", "1"], "(", "z", ")"}], 
      RowBox[{"\[DifferentialD]", "z"}]}]}], "  ", "=", " ", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Kappa]", "2"], 
      RowBox[{
       SubsuperscriptBox["\[Integral]", 
        SubscriptBox["z", "1"], 
        SubscriptBox["z", "2"]], 
       RowBox[{
        RowBox[{"[", " ", 
         RowBox[{
          SuperscriptBox["\[Kappa]", "2"], 
          RowBox[{"T", "(", "z", ")"}]}], " ", "]"}], 
        RowBox[{
         SubscriptBox["N", "1"], "(", "z", ")"}], 
        RowBox[{"\[DifferentialD]", "z"}]}]}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Kappa]", "2"], 
       RowBox[{
        SubsuperscriptBox["\[Integral]", 
         SubscriptBox["z", "1"], 
         SubscriptBox["z", "2"]], 
        RowBox[{
         RowBox[{"[", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[Psi]", "1"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{
               FractionBox["1", "\[CapitalDelta]z"], " ", 
               RowBox[{"(", 
                RowBox[{"z", "-", 
                 SubscriptBox["z", "1"]}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{
            SubscriptBox["\[Psi]", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              FractionBox["1", "\[CapitalDelta]z"], " ", 
              RowBox[{"(", 
               RowBox[{"z", "-", 
                SubscriptBox["z", "1"]}], ")"}]}], ")"}]}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            FractionBox["1", "\[CapitalDelta]z"], " ", 
            RowBox[{"(", 
             RowBox[{"z", "-", 
              SubscriptBox["z", "1"]}], ")"}]}]}], ")"}], 
         RowBox[{"\[DifferentialD]", "z"}]}]}]}], " ", "=", " ", 
      RowBox[{
       SuperscriptBox["\[Kappa]", "2"], "(", 
       RowBox[{
        RowBox[{
         FractionBox["\[CapitalDelta]z", "3"], 
         SubscriptBox["\[Psi]", "1"]}], "+", " ", 
        RowBox[{
         FractionBox["\[CapitalDelta]z", "6"], 
         SubscriptBox["\[Psi]", "2"]}]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"abe7b9c5-f958-47c4-a8c4-063f0343a4a0"],
 "\ni=2, ",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       SubscriptBox["z", "1"], 
       SubscriptBox["z", "M"]], 
      RowBox[{
       RowBox[{"[", " ", 
        RowBox[{
         SuperscriptBox["\[Kappa]", "2"], 
         RowBox[{"T", "(", "z", ")"}]}], " ", "]"}], 
       RowBox[{
        SubscriptBox["N", "2"], "(", "z", ")"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}], "  ", "=", " ", 
     RowBox[{
      SuperscriptBox["\[Kappa]", "2"], 
      RowBox[{
       SubsuperscriptBox["\[Integral]", 
        SubscriptBox["z", "1"], 
        SubscriptBox["z", "3"]], 
       RowBox[{
        RowBox[{"[", " ", 
         RowBox[{
          SuperscriptBox["\[Kappa]", "2"], 
          RowBox[{"T", "(", "z", ")"}]}], " ", "]"}], 
        RowBox[{
         SubscriptBox["N", "2"], "(", "z", ")"}], 
        RowBox[{"\[DifferentialD]", "z"}]}]}]}]}], " "}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", " ", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Kappa]", "2"], 
      RowBox[{
       SubsuperscriptBox["\[Integral]", 
        SubscriptBox["z", "1"], 
        SubscriptBox["z", "2"]], 
       RowBox[{
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[Psi]", "1"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{
              FractionBox["1", "\[CapitalDelta]z"], " ", 
              RowBox[{"(", 
               RowBox[{"z", "-", 
                SubscriptBox["z", "1"]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SubscriptBox["\[Psi]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", "\[CapitalDelta]z"], " ", 
             RowBox[{"(", 
              RowBox[{"z", "-", 
               SubscriptBox["z", "1"]}], ")"}]}], ")"}]}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "\[CapitalDelta]z"], " ", 
          RowBox[{"(", 
           RowBox[{"z", "-", 
            SubscriptBox["z", "1"]}], ")"}]}], ")"}], 
        RowBox[{"\[DifferentialD]", "z"}]}]}]}], "  ", "+", " ", 
     RowBox[{
      SuperscriptBox["\[Kappa]", "2"], 
      RowBox[{
       SubsuperscriptBox["\[Integral]", 
        SubscriptBox["z", "2"], 
        SubscriptBox["z", "3"]], 
       RowBox[{
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[Psi]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{
              FractionBox["1", "\[CapitalDelta]z"], " ", 
              RowBox[{"(", 
               RowBox[{"z", "-", 
                SubscriptBox["z", "2"]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SubscriptBox["\[Psi]", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", "\[CapitalDelta]z"], " ", 
             RowBox[{"(", 
              RowBox[{"z", "-", 
               SubscriptBox["z", "2"]}], ")"}]}], ")"}]}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           FractionBox["1", "\[CapitalDelta]z"], " ", 
           RowBox[{"(", 
            RowBox[{"z", "-", 
             SubscriptBox["z", "2"]}], ")"}]}]}], ")"}], 
        RowBox[{"\[DifferentialD]", "z"}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", "  ", 
    RowBox[{
     SuperscriptBox["\[Kappa]", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["\[CapitalDelta]z", "6"], 
        SubscriptBox["\[Psi]", "1"]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"\[CapitalDelta]z", " ", "2"}], "3"], 
        SubscriptBox["\[Psi]", "2"]}], "+", 
       RowBox[{
        FractionBox["\[CapitalDelta]z", "6"], 
        SubscriptBox["\[Psi]", "3"]}]}], ")"}]}]}], TraditionalForm]}],
  ExpressionUUID->"ae049f2a-21fe-426d-b07c-5b9126447c38"],
 "\ni=M, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      SubscriptBox["z", "1"], 
      SubscriptBox["z", "M"]], 
     RowBox[{
      RowBox[{"[", " ", 
       RowBox[{
        SuperscriptBox["\[Kappa]", "2"], 
        RowBox[{"T", "(", "z", ")"}]}], " ", "]"}], 
      RowBox[{
       SubscriptBox["N", "M"], "(", "z", ")"}], 
      RowBox[{"\[DifferentialD]", "z"}]}]}], " ", "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       SubscriptBox["z", 
        RowBox[{"M", "-", "1"}]], 
       SubscriptBox["z", "M"]], 
      RowBox[{
       RowBox[{"[", " ", 
        RowBox[{
         SuperscriptBox["\[Kappa]", "2"], 
         RowBox[{"T", "(", "z", ")"}]}], " ", "]"}], 
       RowBox[{
        SubscriptBox["N", "M"], "(", "z", ")"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}], " ", "=", " ", 
     RowBox[{"=", " ", 
      RowBox[{
       SuperscriptBox["\[Kappa]", "2"], "(", 
       RowBox[{
        RowBox[{
         FractionBox["\[CapitalDelta]z", "3"], 
         SubscriptBox["\[Psi]", "M"]}], "+", " ", 
        RowBox[{
         FractionBox["\[CapitalDelta]z", "6"], 
         SubscriptBox["\[Psi]", 
          RowBox[{"M", "-", "1"}]]}]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"2b6b3d7d-5aba-44f8-af98-515777eb4349"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SubsuperscriptBox["\[Integral]", 
          SubscriptBox["z", "1"], 
          SubscriptBox["z", "M"]], 
         RowBox[{
          RowBox[{"[", " ", 
           RowBox[{
            SuperscriptBox["\[Kappa]", "2"], 
            RowBox[{"T", "(", "z", ")"}]}], " ", "]"}], 
          RowBox[{
           SubscriptBox["N", "1"], "(", "z", ")"}], 
          RowBox[{"\[DifferentialD]", "z", "  "}]}]}]},
       {
        RowBox[{
         SubsuperscriptBox["\[Integral]", 
          SubscriptBox["z", "1"], 
          SubscriptBox["z", "M"]], 
         RowBox[{
          RowBox[{"[", " ", 
           RowBox[{
            SuperscriptBox["\[Kappa]", "2"], "T", 
            RowBox[{"(", "z", ")"}]}], " ", "]"}], 
          SubscriptBox["N", "2"], 
          RowBox[{"(", "z", ")"}], 
          RowBox[{"\[DifferentialD]", "z"}]}]}]},
       {":"},
       {":"},
       {
        RowBox[{
         SubsuperscriptBox["\[Integral]", 
          SubscriptBox["z", "1"], 
          SubscriptBox["z", "M"]], 
         RowBox[{
          RowBox[{"[", " ", 
           RowBox[{
            SuperscriptBox["\[Kappa]", "2"], 
            RowBox[{"T", "(", "z", ")"}]}], " ", "]"}], 
          RowBox[{
           SubscriptBox["N", "M"], "(", "z", ")"}], 
          RowBox[{"\[DifferentialD]", "z", "  "}]}]}]}
      }], ")"}], "=", " ", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Kappa]", "2"], "\[CapitalDelta]z", " ", 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           FractionBox[
            SubscriptBox["\[Psi]", "1"], "3"], "+", 
           FractionBox[
            SubscriptBox["\[Psi]", "2"], "6"], "  "}]},
         {
          RowBox[{
           FractionBox[
            SubscriptBox["\[Psi]", "1"], "6"], "+", 
           FractionBox[
            RowBox[{"2", " ", 
             SubscriptBox["\[Psi]", "2"]}], "3"], "+", 
           FractionBox[
            SubscriptBox["\[Psi]", "3"], "6"], " "}]},
         {":"},
         {":"},
         {
          RowBox[{
           FractionBox[
            SubscriptBox["\[Psi]", 
             RowBox[{"M", "-", "1"}]], "6"], "+", 
           FractionBox[
            SubscriptBox["\[Psi]", "M"], "3"], "  "}]}
        }], ")"}]}], "=", 
     RowBox[{
      SuperscriptBox["\[Kappa]", "2"], 
      RowBox[{"\[CapitalDelta]z", "(", GridBox[{
         {
          RowBox[{"1", "/", "3"}], 
          RowBox[{"1", "/", "6"}], "...", "...", "...", "0"},
         {
          RowBox[{"1", "/", "6"}], 
          RowBox[{"2", "/", "3"}], 
          RowBox[{"1", "/", "6"}], "...", "...", "0"},
         {"0", 
          RowBox[{"1", "/", "6"}], 
          RowBox[{"2", "/", "3"}], 
          RowBox[{"1", "/", "6"}], "...", "0"},
         {":", ":", ":", ":", ":", ":"},
         {"0", "...", "...", "0", 
          RowBox[{"1", "/", "6"}], 
          RowBox[{"1", "/", "2"}]}
        }], ")"}], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           SubscriptBox["\[Psi]", "1"], "  "}]},
         {
          RowBox[{
           SubscriptBox["\[Psi]", "2"], " "}]},
         {":"},
         {":"},
         {
          RowBox[{
           SubscriptBox["\[Psi]", "M"], " "}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "64d53199-67c8-4099-826f-52b9654770b7"],
 "\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["1", "\[CapitalDelta]z"], 
      RowBox[{"(", GridBox[{
         {"1", 
          RowBox[{"-", "1"}], "...", "...", "...", "0"},
         {
          RowBox[{"-", "1"}], "2", 
          RowBox[{"-", "1"}], "...", "...", "0"},
         {"0", 
          RowBox[{"-", "1"}], "2", 
          RowBox[{"-", "1"}], "...", "0"},
         {":", ":", ":", ":", ":", ":"},
         {"0", "...", "...", "0", 
          RowBox[{"-", "1"}], "1"}
        }], ")"}], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           SubscriptBox["\[Psi]", "1"], "  "}]},
         {
          RowBox[{
           SubscriptBox["\[Psi]", "2"], " "}]},
         {":"},
         {":"},
         {
          RowBox[{
           SubscriptBox["\[Psi]", "M"], " "}]}
        }], ")"}]}], " ", "+", 
     RowBox[{
      SuperscriptBox["\[Kappa]", "2"], 
      RowBox[{"\[CapitalDelta]z", "(", GridBox[{
         {
          RowBox[{"1", "/", "3"}], 
          RowBox[{"1", "/", "6"}], "...", "...", "...", "0"},
         {
          RowBox[{"1", "/", "6"}], 
          RowBox[{"2", "/", "3"}], 
          RowBox[{"1", "/", "6"}], "...", "...", "0"},
         {"0", 
          RowBox[{"1", "/", "6"}], 
          RowBox[{"2", "/", "3"}], 
          RowBox[{"1", "/", "6"}], "...", "0"},
         {":", ":", ":", ":", ":", ":"},
         {"0", "...", "...", "0", 
          RowBox[{"1", "/", "6"}], 
          RowBox[{"1", "/", "3"}]}
        }], ")"}], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           SubscriptBox["\[Psi]", "1"], "  "}]},
         {
          RowBox[{
           SubscriptBox["\[Psi]", "2"], " "}]},
         {":"},
         {":"},
         {
          RowBox[{
           SubscriptBox["\[Psi]", "M"], " "}]}
        }], ")"}]}]}], " ", "=", " ", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[PartialD]", "\[Psi]"}], 
           RowBox[{"\[PartialD]", "z"}]]}], 
         RowBox[{"(", 
          SubscriptBox["z", "1"], ")"}], " "}]},
       {"0"},
       {":"},
       {":"},
       {
        RowBox[{
         FractionBox[
          RowBox[{"\[PartialD]", "\[Psi]"}], 
          RowBox[{"\[PartialD]", "z"}]], 
         RowBox[{"(", 
          SubscriptBox["z", "M"], ")"}], " ", " "}]}
      }], ")"}]}], TraditionalForm]],
  FontFamily->"Times New Roman",
  FontSize->16,ExpressionUUID->"e4c0593e-0e6b-49af-b521-48711b0f2b31"],
 "\nA X + B sinh(X) = C\nA X + corr*B X = -B [sinh(X) - corr*X] + C"
}], "Text",
 CellChangeTimes->{{3.7159102328353977`*^9, 3.715910782963746*^9}, {
   3.7159108369627113`*^9, 3.715911150032731*^9}, {3.715911235822262*^9, 
   3.715911302636354*^9}, {3.71591134336231*^9, 3.715911407746148*^9}, {
   3.715911443367198*^9, 3.715911715701557*^9}, {3.715911790927251*^9, 
   3.715911830225268*^9}, {3.715911874327785*^9, 3.71591199246743*^9}, {
   3.715912031336293*^9, 3.715912108738899*^9}, {3.715912189876203*^9, 
   3.715912198346141*^9}, {3.715912283438386*^9, 3.7159123212592907`*^9}, {
   3.715912523570773*^9, 3.715912550060095*^9}, {3.715912699224244*^9, 
   3.715912743331105*^9}, {3.7159127972933493`*^9, 3.7159128122164783`*^9}, {
   3.715912860045787*^9, 3.71591291973658*^9}, {3.7159133368978243`*^9, 
   3.7159133435650597`*^9}, {3.7159133808265247`*^9, 3.715913641470366*^9}, {
   3.7159136914312353`*^9, 3.715913913342042*^9}, {3.715913996000598*^9, 
   3.715914027587679*^9}, {3.715914094953146*^9, 3.715914114673379*^9}, {
   3.715914158301817*^9, 3.71591421663344*^9}, {3.715914248634842*^9, 
   3.7159142842570343`*^9}, {3.715914403849999*^9, 3.715914542029488*^9}, {
   3.71591472964394*^9, 3.715914786946926*^9}, {3.715914831516116*^9, 
   3.715914958977829*^9}, {3.715915036764229*^9, 3.715915036955057*^9}, {
   3.715915079355777*^9, 3.7159150827074738`*^9}, {3.7159151232180243`*^9, 
   3.7159151588970623`*^9}, {3.7159152649292088`*^9, 
   3.7159153026036243`*^9}, {3.7159153551299562`*^9, 3.715915492014752*^9}, {
   3.715915522314487*^9, 3.715915697581876*^9}, {3.715915738236717*^9, 
   3.715915878629216*^9}, {3.7159165094064093`*^9, 3.7159165097574043`*^9}, 
   3.71591900267268*^9, 3.7159191893641243`*^9, {3.715919316983386*^9, 
   3.715919392662322*^9}, {3.715919458725971*^9, 3.715919517627206*^9}, {
   3.7160435038331833`*^9, 3.716043512542694*^9}, {3.716043697912303*^9, 
   3.716043714623229*^9}, {3.716050088979124*^9, 3.716050138679125*^9}, {
   3.716051344148838*^9, 3.7160513635597963`*^9}, {3.716657110932097*^9, 
   3.7166571950916452`*^9}, {3.716657288119298*^9, 3.716657313655616*^9}, {
   3.716657372649384*^9, 3.716657416205735*^9}, {3.716657447898225*^9, 
   3.716657534018497*^9}, {3.716657606106839*^9, 3.716657678380232*^9}, {
   3.716657743499283*^9, 3.716657777740241*^9}, {3.716657810168832*^9, 
   3.716657917038509*^9}, {3.716657961592153*^9, 3.716658000194418*^9}, {
   3.716658052143889*^9, 3.716658053487129*^9}, {3.7166580837037983`*^9, 
   3.716658391380577*^9}, {3.7166585239330263`*^9, 3.716658553057823*^9}, {
   3.716658645054226*^9, 3.716658685817431*^9}, {3.7166830622770157`*^9, 
   3.716683064300609*^9}, {3.716683176320037*^9, 3.716683200961838*^9}, {
   3.716683384418659*^9, 3.7166834197518473`*^9}, {3.716683456298739*^9, 
   3.7166835381075087`*^9}, {3.71668362171487*^9, 
   3.7166836262679567`*^9}},ExpressionUUID->"26917905-525d-42f0-8f97-\
f212cd05b956"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
FEM solutions for linear PB (The program starts from here, must run before \
the nolinear PB)\
\>", "Subsection",
 CellChangeTimes->{{3.7160466530497913`*^9, 3.716046678303783*^9}, {
  3.716053967617818*^9, 
  3.7160540048950233`*^9}},ExpressionUUID->"c037485b-c373-4a13-baa5-\
e70f739badae"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox["1", "\[CapitalDelta]z"], 
     RowBox[{"(", GridBox[{
        {"1", 
         RowBox[{"-", "1"}], "...", "...", "...", "0"},
        {
         RowBox[{"-", "1"}], "2", 
         RowBox[{"-", "1"}], "...", "...", "0"},
        {"0", 
         RowBox[{"-", "1"}], "2", 
         RowBox[{"-", "1"}], "...", "0"},
        {":", ":", ":", ":", ":", ":"},
        {"0", "...", "...", "0", 
         RowBox[{"-", "1"}], "1"}
       }], ")"}], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          SubscriptBox["\[Psi]", "1"], "  "}]},
        {
         RowBox[{
          SubscriptBox["\[Psi]", "2"], " "}]},
        {":"},
        {":"},
        {
         RowBox[{
          SubscriptBox["\[Psi]", "M"], " "}]}
       }], ")"}]}], " ", "+", 
    RowBox[{
     SuperscriptBox["\[Kappa]", "2"], 
     RowBox[{"\[CapitalDelta]z", "(", GridBox[{
        {
         RowBox[{"1", "/", "3"}], 
         RowBox[{"1", "/", "6"}], "...", "...", "...", "0"},
        {
         RowBox[{"1", "/", "6"}], 
         RowBox[{"2", "/", "3"}], 
         RowBox[{"1", "/", "6"}], "...", "...", "0"},
        {"0", 
         RowBox[{"1", "/", "6"}], 
         RowBox[{"2", "/", "3"}], 
         RowBox[{"1", "/", "6"}], "...", "0"},
        {":", ":", ":", ":", ":", ":"},
        {"0", "...", "...", "0", 
         RowBox[{"1", "/", "6"}], 
         RowBox[{"1", "/", "3"}]}
       }], ")"}], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          SubscriptBox["sinh\[Psi]", "1"], "  "}]},
        {
         RowBox[{
          SubscriptBox["sinh\[Psi]", "2"], " "}]},
        {":"},
        {":"},
        {
         RowBox[{
          SubscriptBox["sinh\[Psi]", "M"], " "}]}
       }], ")"}]}]}], " ", "=", " ", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[PartialD]", "\[Psi]"}], 
          RowBox[{"\[PartialD]", "z"}]]}], 
        RowBox[{"(", 
         SubscriptBox["z", "1"], ")"}], " "}]},
      {"0"},
      {":"},
      {":"},
      {
       RowBox[{
        FractionBox[
         RowBox[{"\[PartialD]", "\[Psi]"}], 
         RowBox[{"\[PartialD]", "z"}]], 
        RowBox[{"(", 
         SubscriptBox["z", "M"], ")"}], " ", " "}]}
     }], ")"}]}], TraditionalForm]],
 FontFamily->"Times New Roman",
 FontSize->16,ExpressionUUID->"4ce6f590-db57-4ff9-80ea-d8fc95bc5ef3"]], "Text",\

 CellChangeTimes->{{3.716658698791308*^9, 
  3.71665871908069*^9}},ExpressionUUID->"d4f3f845-1b60-4c0e-829e-\
0f8d822909af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Psi]0_", ",", "\[Kappa]_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"\[Psi]0", " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "\[Kappa]"}], " ", "z"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7159092291682*^9, 3.7159092532357597`*^9}, {
  3.715909699072794*^9, 3.715909702325162*^9}, {3.715909737269084*^9, 
  3.715909750030239*^9}, {3.716042018070903*^9, 3.7160420741492357`*^9}, {
  3.716042143017024*^9, 3.7160421569618607`*^9}, {3.7160466855814047`*^9, 
  3.7160466859089108`*^9}},ExpressionUUID->"fe25eed4-33e7-4f33-9f0c-\
a4d3b5b3338a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ngrid", "=", 
    RowBox[{"{", 
     RowBox[{"5", ",", "10", ",", "20", ",", "30", ",", "40", ",", "60"}], 
     "}"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "numbers", " ", "of", " ", "grids", " ", "in", " ", "z", " ", "axis"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L", "=", "3"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"range", " ", "of", " ", "domain"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dL", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"L", "/", 
       RowBox[{"ngrid", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ngrid", "]"}]}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"grid", " ", "spacing"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kappa", "=", "2"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"for", " ", "PB"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]0", "=", 
    RowBox[{"-", "6"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"for", " ", "PB"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7159159066175337`*^9, 3.715915969451923*^9}, {
   3.715916461764757*^9, 3.715916487896638*^9}, {3.7159176252282133`*^9, 
   3.715917625738535*^9}, {3.7159178735690317`*^9, 3.715917878837184*^9}, 
   3.715918458679244*^9, {3.715918511411343*^9, 3.715918513921585*^9}, {
   3.715918579314632*^9, 3.7159185794228086`*^9}, 3.715920114747553*^9, {
   3.715920162340748*^9, 3.715920164521763*^9}, {3.7160418069059362`*^9, 
   3.716041807047998*^9}, {3.716043807425661*^9, 3.716043807753228*^9}, {
   3.7160439093147087`*^9, 3.716043910144785*^9}, {3.7160441632062883`*^9, 
   3.7160441636767673`*^9}, {3.7160445012645473`*^9, 
   3.7160445019108477`*^9}, {3.7160446661220417`*^9, 3.716044672968101*^9}, {
   3.716044762765442*^9, 3.7160447636848288`*^9}, {3.716044799828108*^9, 
   3.716044806265945*^9}, {3.716044837621374*^9, 3.716044838253039*^9}, {
   3.716044902820352*^9, 3.7160449031702843`*^9}, {3.716045094452076*^9, 
   3.71604509489249*^9}, {3.716046380206575*^9, 3.716046380342108*^9}, {
   3.716046764185383*^9, 3.716046782139503*^9}, {3.716046827529291*^9, 
   3.7160468298663273`*^9}, {3.7160469890051947`*^9, 3.7160470042632523`*^9}, 
   3.71604759940958*^9, {3.7160486648202963`*^9, 3.716048668753057*^9}, 
   3.716048755534275*^9, {3.7160488725023317`*^9, 3.716048887404093*^9}, {
   3.716049516192994*^9, 3.7160495163018093`*^9}, {3.716049733888401*^9, 
   3.716049734108527*^9}, {3.716050689819261*^9, 3.716050694155067*^9}, {
   3.71605108723107*^9, 3.71605108765094*^9}, {3.716051216579547*^9, 
   3.716051216681222*^9}, {3.7160514070196133`*^9, 3.71605141116057*^9}, {
   3.7160519081040077`*^9, 3.716051908476356*^9}, {3.7160538088483973`*^9, 
   3.7160538950827103`*^9}},ExpressionUUID->"b68d89e2-c0fe-4f0a-b2ce-\
cf45f8bfb3a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MatrixA", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"ngrid", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"ngrid", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "[", "ngrid", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"j", "\[Equal]", "1"}], " ", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"MatrixA", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "1"}], "]"}], "]"}], "=", "1"}], ";", 
           RowBox[{
            RowBox[{
             RowBox[{"MatrixA", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "2"}], "]"}], "]"}], "=", 
            RowBox[{"-", "1"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"j", "\[Equal]", 
           RowBox[{"ngrid", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"MatrixA", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", 
               RowBox[{
                RowBox[{"ngrid", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "-", "1"}]}], "]"}], "]"}], 
            "=", 
            RowBox[{"-", "1"}]}], ";", 
           RowBox[{
            RowBox[{
             RowBox[{"MatrixA", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", 
               RowBox[{"ngrid", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "]"}], "=", "1"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"1", "<", "j", "<", 
           RowBox[{"ngrid", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"MatrixA", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", 
               RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "=", 
            RowBox[{"-", "1"}]}], ";", 
           RowBox[{
            RowBox[{
             RowBox[{"MatrixA", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "j"}], "]"}], "]"}], "=", "2"}], ";", 
           RowBox[{
            RowBox[{
             RowBox[{"MatrixA", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", 
               RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
            RowBox[{"-", "1"}]}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"ngrid", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MatrixA", "[", 
       RowBox[{"[", "k", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"dL", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], " ", 
       RowBox[{"MatrixA", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "[", "ngrid", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.71604684602414*^9, 3.7160469743681097`*^9}, {
   3.716047033078383*^9, 3.7160470401649923`*^9}, 3.7160470943515663`*^9, 
   3.716047271047015*^9, {3.716047403993572*^9, 3.7160474071785107`*^9}, {
   3.71604761347824*^9, 3.716047642215891*^9}, {3.716048450123303*^9, 
   3.716048450740209*^9}},ExpressionUUID->"20463906-dcd3-449d-9d12-\
8c769300380e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MatrixB", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"ngrid", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"ngrid", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "[", "ngrid", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"j", "\[Equal]", "1"}], " ", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"MatrixB", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "1"}], "]"}], "]"}], "=", 
            RowBox[{"1", "/", "3"}]}], ";", 
           RowBox[{
            RowBox[{
             RowBox[{"MatrixB", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "2"}], "]"}], "]"}], "=", 
            RowBox[{"1", "/", "6"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"j", "\[Equal]", 
           RowBox[{"ngrid", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"MatrixB", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", 
               RowBox[{
                RowBox[{"ngrid", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "-", "1"}]}], "]"}], "]"}], 
            "=", 
            RowBox[{"1", "/", "6"}]}], ";", 
           RowBox[{
            RowBox[{
             RowBox[{"MatrixB", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", 
               RowBox[{"ngrid", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "]"}], "=", 
            RowBox[{"1", "/", "3"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"1", "<", "j", "<", 
           RowBox[{"ngrid", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"MatrixB", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", 
               RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "=", 
            RowBox[{"1", "/", "6"}]}], ";", 
           RowBox[{
            RowBox[{
             RowBox[{"MatrixB", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{"2", "/", "3"}]}], ";", 
           RowBox[{
            RowBox[{
             RowBox[{"MatrixB", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", 
               RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
            RowBox[{"1", "/", "6"}]}]}]}], "\[IndentingNewLine]", "]"}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"ngrid", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MatrixB", "[", 
       RowBox[{"[", "k", "]"}], "]"}], "=", 
      RowBox[{
       SuperscriptBox["kappa", "2"], 
       RowBox[{"dL", "[", 
        RowBox[{"[", "k", "]"}], "]"}], " ", 
       RowBox[{"MatrixB", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "[", "ngrid", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.716047712713459*^9, 3.716047792863124*^9}, 
   3.7160478702285357`*^9, {3.7160479084424973`*^9, 3.71604800725738*^9}, {
   3.7160484597318363`*^9, 
   3.716048460356326*^9}},ExpressionUUID->"0a4aab8b-083a-4bf4-80d6-\
3e6ede3dbf85"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Vec", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ngrid", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Vec", "[", 
      RowBox[{"[", "k", "]"}], "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"ngrid", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Vec", "[", 
       RowBox[{"[", "k", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Psi]", "[", 
          RowBox[{"\[Psi]0", ",", "kappa", ",", "z"}], "]"}], ",", "z"}], 
        "]"}]}], "/.", 
      RowBox[{"z", "\[Rule]", "0"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Vec", "[", 
       RowBox[{"[", "k", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"ngrid", "[", 
        RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"\[Psi]0", ",", "kappa", ",", "z"}], "]"}], ",", "z"}], 
       "]"}], "/.", 
      RowBox[{"z", "\[Rule]", 
       RowBox[{
        RowBox[{"dL", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ngrid", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "-", "1"}], ")"}]}]}]}]}], ";"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "[", "ngrid", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.716048076926486*^9, 3.7160481506190147`*^9}, {
  3.7160489129522247`*^9, 
  3.716048921157181*^9}},ExpressionUUID->"31a1d702-f245-4864-9d6c-\
6766501c0893"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FEMsol", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ngrid", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FEMsol", "[", 
      RowBox[{"[", "k", "]"}], "]"}], "=", 
     RowBox[{"LinearSolve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MatrixA", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "+", 
        RowBox[{"MatrixB", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], ",", 
       RowBox[{"Vec", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "[", "ngrid", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.716048214801516*^9, 3.7160482370775127`*^9}, {
  3.716048433970598*^9, 
  3.71604843474856*^9}},ExpressionUUID->"485bce19-e712-48d3-b360-\
dcadfc8e884f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Pana", "=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"\[Psi]", "[", 
        RowBox[{"\[Psi]0", ",", "kappa", ",", "z"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "0", ",", "L"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\!\(\*FractionBox[\(\*SuperscriptBox[\(d\), \(2\)] \[Psi]\), \
SuperscriptBox[\(dz\), \(2\)]]\) = \!\(\*SuperscriptBox[\(\[Kappa]\), \
\(2\)]\)\[Psi]\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "16"}]}], "]"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<\[Psi](z)=\!\(\*SubscriptBox[\(\[Psi]\), \(0\)]\)exp(-\
\[Kappa]z)\>\"", ",", 
             RowBox[{"FontSize", "\[Rule]", "16"}]}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.5", ",", "0.5"}], "}"}]}], "]"}]}]}], "]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"\[Psi]0", ",", "0"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", "Thick"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<z (\!\(\*SubscriptBox[\(\[Lambda]\), \(D\)]\))\>\"", ",", 
        "\"\<\[Psi]\>\""}], "}"}]}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontWeight", "\[Rule]", "\"\<Bold\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "16"}]}], "}"}]}], ",", 
     RowBox[{"AxesStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Black", ",", "Black"}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7159182534137373`*^9, 3.71591826934044*^9}, {
   3.715918300227674*^9, 3.715918314298909*^9}, {3.715918350029736*^9, 
   3.715918428563814*^9}, 3.715918470797594*^9, {3.7159186570545893`*^9, 
   3.715918660757888*^9}, {3.715919063507245*^9, 3.715919091707287*^9}, {
   3.7159203426368523`*^9, 3.7159204404096518`*^9}, {3.716044694376582*^9, 
   3.716044695250095*^9}, {3.716048683996645*^9, 3.716048700069046*^9}, {
   3.716048928224743*^9, 3.716048958864141*^9}, {3.7160507106918497`*^9, 
   3.716050712154798*^9}, {3.716050978527265*^9, 3.7160509790053988`*^9}, {
   3.716051175239649*^9, 3.7160511973266582`*^9}, {3.716052810684415*^9, 
   3.716052872953514*^9}, {3.7160529218843927`*^9, 3.7160530026938467`*^9}, {
   3.7160533000036917`*^9, 
   3.716053307670336*^9}},ExpressionUUID->"a4d6f81a-02d4-4f6a-874d-\
6ac260c3f0fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Plist", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"dL", "[", 
             RowBox[{"[", "k", "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"FEMsol", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"ngrid", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"PlotMarkers", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\[FilledDiamond]\>\"", ",", " ", "10", ",", "Blue"}], 
         "]"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{"\"\<FEM ngrid = \>\"", ",", 
                RowBox[{"ngrid", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"FontSize", "\[Rule]", "16"}]}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.46", ",", "0.3"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Gray"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "[", "ngrid", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7160483030739*^9, 3.716048379637837*^9}, {
  3.7160509832292557`*^9, 3.7160509839250174`*^9}, {3.716051430722007*^9, 
  3.7160514310324097`*^9}, {3.7160530091809053`*^9, 
  3.716053050912369*^9}},ExpressionUUID->"db8bb487-19e3-442d-9f9b-\
6b733ff18187"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{"Pana", ",", 
     RowBox[{"Plist", "[", 
      RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", 
     RowBox[{"Length", "[", "ngrid", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7160526891684647`*^9, 
  3.7160526908639317`*^9}},ExpressionUUID->"49326a43-9885-4ca8-8e6c-\
0a02176b3109"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`n$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`n$$], 1, 6, 1}}, Typeset`size$$ = {
    360., {144., 149.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`n$9054$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`n$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`n$$, $CellContext`n$9054$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[$CellContext`Pana, 
        Part[$CellContext`Plist, $CellContext`n$$]], 
      "Specifications" :> {{$CellContext`n$$, 1, 6, 1, Appearance -> "Open"}},
       "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{405., {203., 209.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.716052692045615*^9, 3.71605306594024*^9, 
  3.716513032530094*^9, 3.716658592869578*^9, 
  3.716957793724513*^9},ExpressionUUID->"f49efdb5-440a-4519-90f3-\
63c09f8c1451"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
FEM solutions for nonlinear PB (use initial guess from the linear PB)\
\>", "Subsection",
 CellChangeTimes->{{3.7160466530497913`*^9, 3.716046678303783*^9}, {
  3.716046744395342*^9, 3.716046744723825*^9}, {3.716051006572996*^9, 
  3.7160510195293493`*^9}, {3.716051324765923*^9, 
  3.716051325396902*^9}},ExpressionUUID->"80e60dd9-7b28-4e09-9425-\
ef68e147188e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Psi]NL", "[", 
   RowBox[{"\[Psi]0_", ",", "\[Kappa]_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"4", " ", 
   RowBox[{"ArcTanh", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "\[Kappa]"}], " ", "z"}], "]"}], " ", 
     RowBox[{"Tanh", "[", 
      RowBox[{"\[Psi]0", "/", "4"}], "]"}]}], "]"}]}]}]], "Input",ExpressionUU\
ID->"87b63b1b-bfd9-448a-9548-368de7099e87"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VecNL", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ngrid", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"VecNL", "[", 
      RowBox[{"[", "k", "]"}], "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"ngrid", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"VecNL", "[", 
       RowBox[{"[", "k", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Psi]NL", "[", 
          RowBox[{"\[Psi]0", ",", "kappa", ",", "z"}], "]"}], ",", "z"}], 
        "]"}]}], "/.", 
      RowBox[{"z", "\[Rule]", "0"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"VecNL", "[", 
       RowBox[{"[", "k", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"ngrid", "[", 
        RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"\[Psi]NL", "[", 
         RowBox[{"\[Psi]0", ",", "kappa", ",", "z"}], "]"}], ",", "z"}], 
       "]"}], "/.", 
      RowBox[{"z", "\[Rule]", 
       RowBox[{
        RowBox[{"dL", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ngrid", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "-", "1"}], ")"}]}]}]}]}], ";"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "[", "ngrid", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.716050280243966*^9, 
  3.7160502953623657`*^9}},ExpressionUUID->"362aa3db-2c26-4923-8a31-\
2547573cd422"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"oldsol", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ngrid", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newsol", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ngrid", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"stop", "=", "False"}], ";", "\[IndentingNewLine]", 
    RowBox[{"imax", "=", "150"}], ";", "\[IndentingNewLine]", 
    RowBox[{"tol", "=", 
     SuperscriptBox["10", 
      RowBox[{"-", "4"}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{"corr", "=", "40"}], ";", 
    RowBox[{"(*", 
     RowBox[{
     "to", " ", "prevent", " ", "getting", " ", "too", " ", "small", " ", 
      "numbers", " ", "than", " ", "computer", " ", "limit"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"oldsol", "[", 
      RowBox[{"[", "k", "]"}], "]"}], "=", 
     RowBox[{"N", "[", 
      RowBox[{"FEMsol", "[", 
       RowBox[{"[", "k", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fsol", "=", 
        RowBox[{
         RowBox[{"Sinh", "[", 
          RowBox[{"oldsol", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "]"}], "-", 
         RowBox[{
          RowBox[{"oldsol", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "*", "corr"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Bfsol", "=", 
        RowBox[{
         RowBox[{"MatrixB", "[", 
          RowBox[{"[", "k", "]"}], "]"}], ".", "fsol"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"newsol", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "=", 
        RowBox[{"LinearSolve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MatrixA", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "+", 
           RowBox[{"corr", "*", 
            RowBox[{"MatrixB", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"-", "Bfsol"}], "+", 
           RowBox[{"VecNL", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"newsol", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "-", 
              RowBox[{
               RowBox[{"oldsol", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ">", 
            SuperscriptBox["10", 
             RowBox[{"-", "4"}]]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"oldsol", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "=", 
             RowBox[{"newsol", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], ";", 
            RowBox[{"Break", "[", "]"}]}], ",", 
           RowBox[{"stop", "=", "True"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"newsol", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"stop", "\[Equal]", "True"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Numerical solutions converged at \>\"", ",", "i", ",", 
            "\"\<th iteration\>\""}], "]"}], ";", 
          RowBox[{"Break", "[", "]"}]}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[Equal]", "imax"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Failed to converge in \>\"", ",", "imax", ",", 
             "\"\< iterations.\\n Errors: \>\"", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"newsol", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "-", 
                 RowBox[{
                  RowBox[{"oldsol", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"newsol", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "imax"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "[", "ngrid", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.716045159287489*^9, 3.716045377761278*^9}, {
   3.716045422921164*^9, 3.716045471552143*^9}, {3.716045524673983*^9, 
   3.716045811301448*^9}, {3.716045872395705*^9, 3.716046134401476*^9}, {
   3.716046180211005*^9, 3.716046185512412*^9}, 3.71604622325041*^9, {
   3.716048492387559*^9, 3.716048537856608*^9}, {3.716048618695448*^9, 
   3.716048618780492*^9}, {3.716049601741356*^9, 3.716049602052923*^9}, {
   3.7160496819816427`*^9, 3.716049690081852*^9}, {3.7160499724105473`*^9, 
   3.716049979950634*^9}, {3.71605020704508*^9, 3.716050207360632*^9}, {
   3.71605031684764*^9, 3.716050316953101*^9}, {3.716050371770795*^9, 
   3.716050588220642*^9}, {3.71605103823787*^9, 3.716051074605126*^9}, {
   3.716051111884848*^9, 3.716051122243126*^9}, {3.71605150671496*^9, 
   3.716051506852256*^9}, 3.716051568281904*^9, {3.716051630427802*^9, 
   3.7160516505416327`*^9}, {3.716051759661631*^9, 3.716051763507411*^9}, {
   3.716051813031537*^9, 3.7160518267671137`*^9}, {3.7160519399418707`*^9, 
   3.716051940277184*^9}},ExpressionUUID->"b313ebfc-f7ea-4427-b7c5-\
596f66a66722"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Numerical solutions converged at \"\>", "\[InvisibleSpace]", 
   "62", "\[InvisibleSpace]", "\<\"th iteration\"\>"}],
  SequenceForm["Numerical solutions converged at ", 62, "th iteration"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.71605181776899*^9, 3.716051829138097*^9}, {
   3.716051934900738*^9, 3.716051940604051*^9}, 3.716052206523745*^9, 
   3.716513034267275*^9, 3.7166585993644667`*^9, 
   3.716957795212675*^9},ExpressionUUID->"144a0456-5981-460d-b033-\
dde042701007"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Numerical solutions converged at \"\>", "\[InvisibleSpace]", 
   "67", "\[InvisibleSpace]", "\<\"th iteration\"\>"}],
  SequenceForm["Numerical solutions converged at ", 67, "th iteration"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.71605181776899*^9, 3.716051829138097*^9}, {
   3.716051934900738*^9, 3.716051940604051*^9}, 3.716052206523745*^9, 
   3.716513034267275*^9, 3.7166585993644667`*^9, 
   3.7169577952209253`*^9},ExpressionUUID->"4a962e60-2894-482f-bd0f-\
d7dae5ccf59d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Numerical solutions converged at \"\>", "\[InvisibleSpace]", 
   "68", "\[InvisibleSpace]", "\<\"th iteration\"\>"}],
  SequenceForm["Numerical solutions converged at ", 68, "th iteration"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.71605181776899*^9, 3.716051829138097*^9}, {
   3.716051934900738*^9, 3.716051940604051*^9}, 3.716052206523745*^9, 
   3.716513034267275*^9, 3.7166585993644667`*^9, 
   3.716957795279812*^9},ExpressionUUID->"59669683-56be-4537-8ad1-\
a96feb0de91e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Numerical solutions converged at \"\>", "\[InvisibleSpace]", 
   "102", "\[InvisibleSpace]", "\<\"th iteration\"\>"}],
  SequenceForm["Numerical solutions converged at ", 102, "th iteration"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.71605181776899*^9, 3.716051829138097*^9}, {
   3.716051934900738*^9, 3.716051940604051*^9}, 3.716052206523745*^9, 
   3.716513034267275*^9, 3.7166585993644667`*^9, 
   3.7169577953311167`*^9},ExpressionUUID->"92870cee-c699-4652-9e0f-\
8cf373b951d8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Numerical solutions converged at \"\>", "\[InvisibleSpace]", 
   "80", "\[InvisibleSpace]", "\<\"th iteration\"\>"}],
  SequenceForm["Numerical solutions converged at ", 80, "th iteration"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.71605181776899*^9, 3.716051829138097*^9}, {
   3.716051934900738*^9, 3.716051940604051*^9}, 3.716052206523745*^9, 
   3.716513034267275*^9, 3.7166585993644667`*^9, 
   3.7169577953872538`*^9},ExpressionUUID->"680a8925-9185-4465-aaa7-\
d8ad505ee200"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Numerical solutions converged at \"\>", "\[InvisibleSpace]", 
   "50", "\[InvisibleSpace]", "\<\"th iteration\"\>"}],
  SequenceForm["Numerical solutions converged at ", 50, "th iteration"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.71605181776899*^9, 3.716051829138097*^9}, {
   3.716051934900738*^9, 3.716051940604051*^9}, 3.716052206523745*^9, 
   3.716513034267275*^9, 3.7166585993644667`*^9, 
   3.716957795490232*^9},ExpressionUUID->"f5da5fea-a389-4ae1-8e57-\
15b1348df931"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"PanaNL", "=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"\[Psi]NL", "[", 
        RowBox[{"\[Psi]0", ",", "kappa", ",", "z"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "0", ",", "L"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\!\(\*FractionBox[\(\*SuperscriptBox[\(d\), \(2\)] \[Psi]\), \
SuperscriptBox[\(dz\), \(2\)]]\) = \!\(\*SuperscriptBox[\(\[Kappa]\), \
\(2\)]\)sinh(\[Psi])\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "16"}]}], "]"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<\[Psi](z)=4\!\(\*SuperscriptBox[\(Tanh\), \
\(-1\)]\)(\!\(\*SuperscriptBox[\(e\), \
\(-\[Kappa]z\)]\)Tanh(\!\(\*FractionBox[\(\[Psi]0\), \(4\)]\)))\>\"", ",", 
             RowBox[{"FontSize", "\[Rule]", "16"}]}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.55", ",", "0.37"}], "}"}]}], "]"}]}]}], "]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"\[Psi]0", ",", "1.5"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", "Thick"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<z (\!\(\*SubscriptBox[\(\[Lambda]\), \(D\)]\))\>\"", ",", 
        "\"\<\[Psi]\>\""}], "}"}]}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontWeight", "\[Rule]", "\"\<Bold\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "16"}]}], "}"}]}], ",", 
     RowBox[{"AxesStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Black", ",", "Black"}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7160462595634003`*^9, 3.7160463267631283`*^9}, 
   3.716048796048937*^9, {3.716049633888002*^9, 3.7160496545331697`*^9}, {
   3.716050046523444*^9, 3.716050050284289*^9}, 3.716050610183544*^9, {
   3.716050658682016*^9, 3.716050673893332*^9}, {3.716050747067247*^9, 
   3.716050764720068*^9}, {3.716050813395513*^9, 3.71605096338232*^9}, {
   3.716051168549479*^9, 3.716051168786449*^9}, {3.716052214349276*^9, 
   3.716052223991535*^9}, {3.716053095348575*^9, 3.716053160977468*^9}, {
   3.716053253237749*^9, 
   3.716053277064969*^9}},ExpressionUUID->"4bbbc0f0-da54-4b63-9ba6-\
cf2cb32431f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PNLlist", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"dL", "[", 
             RowBox[{"[", "k", "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"newsol", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"ngrid", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"PlotMarkers", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\[FilledDiamond]\>\"", ",", " ", "10", ",", "Blue"}], 
         "]"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{"\"\<FEM ngrid = \>\"", ",", 
                RowBox[{"ngrid", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"FontSize", "\[Rule]", "16"}]}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.4", ",", "0.23"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Gray"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "[", "ngrid", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7160483030739*^9, 3.716048379637837*^9}, {
  3.7160506158318167`*^9, 3.716050622770215*^9}, {3.716050945467441*^9, 
  3.7160509484972277`*^9}, {3.716051948416237*^9, 3.716051948731855*^9}, {
  3.716053173521963*^9, 
  3.716053214612248*^9}},ExpressionUUID->"c6a629a9-9b35-4ccf-b780-\
03ec31ea29f2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{"PanaNL", ",", 
     RowBox[{"PNLlist", "[", 
      RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", 
     RowBox[{"Length", "[", "ngrid", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.716052547544351*^9, 
  3.716052630329068*^9}},ExpressionUUID->"432b6aa1-67d8-452b-8224-\
2ea24fb8e292"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`n$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`n$$], 1, 6, 1}}, Typeset`size$$ = {
    360., {144., 149.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`n$9645$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`n$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`n$$, $CellContext`n$9645$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[$CellContext`PanaNL, 
        Part[$CellContext`PNLlist, $CellContext`n$$]], 
      "Specifications" :> {{$CellContext`n$$, 1, 6, 1, Appearance -> "Open"}},
       "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{405., {203., 209.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.716052588632493*^9, 3.716052631010635*^9}, 
   3.716513034791431*^9, 3.716658600013754*^9, 
   3.7169577959190474`*^9},ExpressionUUID->"62837037-ae30-4189-a76f-\
221f1870e85c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Performance on linear and nonliner PB", "Subsection",
 CellChangeTimes->{{3.7160466530497913`*^9, 3.716046678303783*^9}, {
  3.716046744395342*^9, 3.716046744723825*^9}, {3.716051006572996*^9, 
  3.7160510195293493`*^9}, {3.716051324765923*^9, 3.716051325396902*^9}, {
  3.716053519881915*^9, 
  3.716053532847459*^9}},ExpressionUUID->"5ed9799f-cbc9-4bab-ac5c-\
ab79806ed1b3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"\[Psi]", "[", 
      RowBox[{"\[Psi]0", ",", "kappa", ",", "z"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "0", ",", "L"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<\[Psi](z)=\!\(\*SuperscriptBox[\(\[Psi]0e\), \(-\[Kappa]z\)]\)\>\
\"", ",", 
         RowBox[{"FontSize", "\[Rule]", "16"}]}], "]"}], "}"}]}]}], "]"}], 
   ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"\[Psi]NL", "[", 
      RowBox[{"\[Psi]0", ",", "kappa", ",", "z"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "0", ",", "L"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Purple"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<\[Psi](z)=4\!\(\*SuperscriptBox[\(Tanh\), \
\(-1\)]\)(\!\(\*SuperscriptBox[\(e\), \
\(-\[Kappa]z\)]\)Tanh(\!\(\*FractionBox[\(\[Psi]0\), \(4\)]\)))\>\"", ",", 
         RowBox[{"FontSize", "\[Rule]", "16"}]}], "]"}], "}"}]}]}], "]"}], 
   ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"\[Psi]0", ",", "0"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", "Thick"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<z (\!\(\*SubscriptBox[\(\[Lambda]\), \(D\)]\))\>\"", ",", 
      "\"\<\[Psi]\>\""}], "}"}]}], ",", 
   RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontWeight", "\[Rule]", "\"\<Bold\>\""}], ",", 
      RowBox[{"FontSize", "\[Rule]", "16"}]}], "}"}]}], ",", 
   RowBox[{"AxesStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Black", ",", "Black"}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.716053434482738*^9, 3.716053500279841*^9}, {
  3.7165130472517347`*^9, 
  3.716513054325947*^9}},ExpressionUUID->"a191d947-5346-47b2-a494-\
ae36ee437cb8"],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{{{{}, {}, 
        TagBox[{
          Directive[
           Opacity[1.], 
           AbsoluteThickness[1.6], 
           RGBColor[1, 0, 0]], 
          LineBox[CompressedData["
1:eJwB4QQe+yFib1JlAgAAAE0AAAACAAAA+EtunVBvcD5aDrLO//8XwIZkJyjP
Jk4/H768G7T0F8DN7uRqjSZeP7jyxLlt6RfA8LNDjGwmbj+63sze8NIXwIIW
8xxcJn4/PkT1hjamF8DLx0rlUyaOP8/2USW9TRfAb6B2yU8mnj/luDCEpqAW
wMGMjLtNJq4/ViXozmRVFcAFBnIH6Wq/P07mJsDFxhLASX9hhbVWxz/qE1c/
kKoQwLd5Zd2l0c4/0By9ct2nDcDZWmsvcnfTP1qB+XPZHwrAEUeNZsFA1z+M
UiBjijUHwBDUZbI3W9s/5MegKHtqBMAjIGyphWLfPx7cYRU+AALAON1ty0GS
4T9rEETFqAEAwMH6gEzUm+M/RAJvCXYv/L9ov8jIvoLlP/wObLu8Bvm/mWOn
GhVg5z+SjRvI+UX2vy1Y4fb+Zek/A3V8Ybeg87/e80/OQEnrP4mByNOFcfG/
8t8ZMBZV7T+Eo2Ht4bLuv5CremdXV+8/ZucnbJ8T678mDwhNeJvwP/CTH6S3
Fei/tnCAq46f8T+cPsazYDblv9QlkwdRkvI/uDdiCmDX4r8kg9MoXZnzP/Ca
k8n9keC/OVDfNJ+b9D/MDrOV1jbdv91whT6NjPU/SrFlCsz42b+yOVkNxZH2
P9KLc7ic3Na/FlbH2aiF9z+ziTAoi0vUvz/iAJHCdPg/qRXR0QoP0r+ZFmgN
Jnj5PzKanbQm0s+/gp5phzVq+j/IESoWDUbMv53OmMaOcPs/SfKKmMnfyL99
bpPwHXL8PxgSGaRG78W/62EoGFli/T+Wr7IuxIHDv4v96gTeZv4/FNlJ80Qt
wb+67EfvDlr/P5u8uaXYgb6/1iU44jokAED8frLppCe7v2gpYy+TpQBAgveh
lMDut7/BVlt7QR4BQDLVANSfRbW/M1jqqRShAUCSC4TVgbiyv2yDRtc9GwJA
Dae/Co+dsL+IZgj6AZMCQGko63IdkK2/vR1h/+oUA0D+OHz6Ywqqv7n+hgMq
jgNAufp10/8hp7/Os0PqjREEQI7tTT7fWKS/xSBmxoySBECIrmq2WPChv4S3
VaHhCgVAzrU/KWTmn79cItxeW40FQJczv9FpFZy/+7YvGysHBkBPEgBIGO+Y
v3wD6cyVfgZA9m+j/Hkwlr8WJDlhJQAHQLiTIhhejZO/d25W9Ap5B0BrRRgR
+F+Rvxw2ZMgmewdAenDSndFWkb/A/XGcQn0HQPWWKfyvTZG/Co2NRHqBB0AS
hokjezuRv56rxJTpiQdAAW1V1koXkb/G6DI1yJoHQNtVoprNz5C/FGMPdoW8
B0Cif+ZWT0SQv7kqHUqhvgdAG7gKRr47kL9e8ioevcAHQLAtILgxM5C/qIFG
xvTEB0BsI58bJiKQvzugfRZkzQdAjGy1nUQAkL9i3eu2Qt4HQBYdLgGteo+/
B6X5il7gB0CTrtYIGWqPv6xsB1964gdAIMCDy41Zj7/2+yIHsuYHQN+qiW+R
OI+/ihpaVyHvB0CO5B+yAPeOvy/iZys98QdAPLe2EbLmjr/UqXX/WPMHQD5G
zQds1o6/HjmRp5D3B0AWxGSl+bWOv8MAn3us+QdAcjvhQ82ljr9oyKxPyPsH
QKp91GaplY6/DJC6I+T9B0B9PMIJjoWOv7FXyPf//wdAToYwKHt1jr/yEGaq

           "]]}, 
         Annotation[#, 
          "Charting`Private`Tag$9937#1"]& ]}}, {}, {}}, {{{{}, {}, 
        TagBox[{
          Directive[
           Opacity[1.], 
           AbsoluteThickness[1.6], 
           RGBColor[0.5, 0, 0.5]], 
          LineBox[CompressedData["
1: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
           "]]}, 
         Annotation[#, "Charting`Private`Tag$9992#1"]& ]}}, {}, {}}}, {
    PlotRange -> {All, {-6, 0}}, Frame -> True, FrameStyle -> 
     Thickness[Large], FrameLabel -> {
       FormBox[
       "\"z (\\!\\(\\*SubscriptBox[\\(\[Lambda]\\), \\(D\\)]\\))\"", 
        TraditionalForm], 
       FormBox["\"\[Psi]\"", TraditionalForm]}, LabelStyle -> GrayLevel[0], 
     BaseStyle -> {FontWeight -> "Bold", FontSize -> 16}, AxesStyle -> {
       GrayLevel[0], 
       GrayLevel[0]}, ImageSize -> Medium, DisplayFunction -> Identity, 
     Ticks -> {Automatic, Automatic}, AxesOrigin -> {0, 0}, 
     FrameTicks -> {{Automatic, 
        Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
        Charting`ScaledFrameTicks[{Identity, Identity}]}}, 
     GridLines -> {None, None}, DisplayFunction -> Identity, 
     PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, PlotRangeClipping -> True, ImagePadding -> All, 
     DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, DisplayFunction :> 
     Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {
      "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
       AbsolutePointSize[6], "ScalingFunctions" -> None, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& )}}, PlotRange -> {All, All}, PlotRangeClipping -> 
     True, PlotRangePadding -> {{Automatic, Automatic}, {
       Automatic, Automatic}}, Ticks -> {Automatic, Automatic}}],FormBox[
    TagBox[
     GridBox[{{
        FormBox[
         TemplateBox[{
           StyleBox[
           "\"\[Psi](z)=\\!\\(\\*SuperscriptBox[\\(\[Psi]0e\\), \\(-\[Kappa]z\
\\)]\\)\"", FontSize -> 16, StripOnInput -> False]}, "LineLegend", 
          DisplayFunction -> (StyleBox[
            StyleBox[
             PaneBox[
              TagBox[
               GridBox[{{
                  TagBox[
                   GridBox[{{
                    GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0, 0]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0, 0]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                    AutoDelete -> False, 
                    GridBoxDividers -> {
                    "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                    GridBoxItemSize -> {
                    "Columns" -> {{All}}, "Rows" -> {{All}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
               "Grid"], Alignment -> Left, AppearanceElements -> None, 
              ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
              "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
            FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
            False]& ), InterpretationFunction :> (RowBox[{"LineLegend", "[", 
             RowBox[{
               RowBox[{"{", 
                 RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                    RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                    InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[1, 0, 0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> RGBColor[0.6666666666666666, 0., 0.], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[1, 0, 0]"], Appearance -> None, BaseStyle -> {},
                     BaselinePosition -> Baseline, DefaultBaseStyle -> {}, 
                    ButtonFunction :> With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0, 0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[1, 0, 0], Editable -> False, Selectable -> 
                    False]}], "]"}], "}"}], ",", 
               RowBox[{"{", #, "}"}], ",", 
               RowBox[{"LegendMarkers", "\[Rule]", "None"}], ",", 
               RowBox[{"LabelStyle", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", 
               RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
          Editable -> True], TraditionalForm]}, {
        FormBox[
         TemplateBox[{
           StyleBox[
           "\"\[Psi](z)=4\\!\\(\\*SuperscriptBox[\\(Tanh\\), \\(-1\\)]\\)(\\!\
\\(\\*SuperscriptBox[\\(e\\), \
\\(-\[Kappa]z\\)]\\)Tanh(\\!\\(\\*FractionBox[\\(\[Psi]0\\), \\(4\\)]\\)))\"",
             FontSize -> 16, StripOnInput -> False]}, "LineLegend", 
          DisplayFunction -> (StyleBox[
            StyleBox[
             PaneBox[
              TagBox[
               GridBox[{{
                  TagBox[
                   GridBox[{{
                    GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0.5, 0, 0.5]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0.5, 0, 0.5]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                    AutoDelete -> False, 
                    GridBoxDividers -> {
                    "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                    GridBoxItemSize -> {
                    "Columns" -> {{All}}, "Rows" -> {{All}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
               "Grid"], Alignment -> Left, AppearanceElements -> None, 
              ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
              "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
            FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
            False]& ), InterpretationFunction :> (RowBox[{"LineLegend", "[", 
             RowBox[{
               RowBox[{"{", 
                 RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                    RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                    InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.5, 0, 0.5], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[0.33333333333333337`, 0., 0.33333333333333337`], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.5, 0, 0.5]"], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.5, 0, 0.5]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.5, 0, 0.5], Editable -> False, Selectable -> 
                    False]}], "]"}], "}"}], ",", 
               RowBox[{"{", #, "}"}], ",", 
               RowBox[{"LegendMarkers", "\[Rule]", "None"}], ",", 
               RowBox[{"LabelStyle", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", 
               RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
          Editable -> True], TraditionalForm]}}, 
      GridBoxAlignment -> {"Columns" -> {{Left}}}, AutoDelete -> False, 
      GridBoxItemSize -> {
       "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
      GridBoxSpacings -> {"Columns" -> {{0}}}], "Grid"], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{3.716053465494179*^9, 3.716053500920092*^9, 
  3.71651305746072*^9, 
  3.716957802370229*^9},ExpressionUUID->"0cc2e545-2a15-4b4f-89c5-\
5d3f418fb42b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{"Pana", ",", 
         RowBox[{"Plist", "[", 
          RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"Show", "[", 
        RowBox[{"PanaNL", ",", 
         RowBox[{"PNLlist", "[", 
          RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}], "}"}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", 
     RowBox[{"Length", "[", "ngrid", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.716053354091567*^9, 3.7160533768335133`*^9}, {
  3.716953840968666*^9, 
  3.7169538423600283`*^9}},ExpressionUUID->"c95a6334-f34e-4f2d-a72f-\
42b8bf0c8157"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`n$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`n$$], 1, 6, 1}}, Typeset`size$$ = {
    729., {134.634033203125, 140.365966796875}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`n$10263$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`n$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`n$$, $CellContext`n$10263$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Grid[{{
          Show[$CellContext`Pana, 
           Part[$CellContext`Plist, $CellContext`n$$]], 
          Show[$CellContext`PanaNL, 
           Part[$CellContext`PNLlist, $CellContext`n$$]]}}], 
      "Specifications" :> {{$CellContext`n$$, 1, 6, 1, Appearance -> "Open"}},
       "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{774., {194., 200.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.716053366254488*^9, 3.716053377536673*^9}, 
   3.7165130587341127`*^9, 3.716955038600322*^9, 
   3.7169578063104267`*^9},ExpressionUUID->"7679d7b1-2664-4c29-ae1a-\
ecd32b43766b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\<~/Desktop\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.716960468483962*^9, 
  3.716960476180257*^9}},ExpressionUUID->"0ae3d521-ba86-4ee9-b59a-\
95264b701b77"],

Cell[BoxData["\<\"/Volumes/750G_Home/Users/appleowner/Desktop\"\>"], "Output",
 CellChangeTimes->{
  3.716960476709475*^9},ExpressionUUID->"79aff227-d020-48d3-b50a-\
467d7b1f1c04"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directory", "[", "]"}], ",", "\"\<t1.pdf\>\""}], "}"}], 
      "]"}], ",", 
     RowBox[{"Grid", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{"Pana", ",", 
           RowBox[{"Plist", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"Show", "[", 
          RowBox[{"PanaNL", ",", 
           RowBox[{"PNLlist", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}], "}"}], "}"}], "]"}]}], 
    "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.716957816289177*^9, 3.716957889277657*^9}, {
  3.7169579831337748`*^9, 3.716958019503427*^9}, {3.716958255383761*^9, 
  3.716958287744152*^9}, {3.716958318327313*^9, 3.71695832170055*^9}, {
  3.716958359236946*^9, 3.716958359818756*^9}, {3.716959392950453*^9, 
  3.716959465803129*^9}},ExpressionUUID->"7df19f30-ffcc-4f04-ab85-\
e329af9113ff"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"First", "@", 
    RowBox[{"Import", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directory", "[", "]"}], ",", 
        RowBox[{"\"\<p\>\"", "<>", 
         RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<.pdf\>\""}]}], "}"}],
       "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "6", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7169596339035683`*^9, 3.7169596561466427`*^9}, {
  3.71696049355799*^9, 3.716960495341064*^9}, {3.7169605258689404`*^9, 
  3.716960564313381*^9}},ExpressionUUID->"9e187865-65bc-4c36-ac8c-\
f494da26d1e3"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`n$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`n$$], 1, 6, 1}}, Typeset`size$$ = {527., {95., 100.}},
     Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`n$35252$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`n$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`n$$, $CellContext`n$35252$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> First[
        Import[
         FileNameJoin[{
           Directory[], 
           StringJoin["p", 
            ToString[$CellContext`n$$], ".pdf"]}]]], 
      "Specifications" :> {{$CellContext`n$$, 1, 6, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{572., {140., 146.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.71695957637652*^9, {3.716959637876449*^9, 3.7169596572854652`*^9}, {
   3.716960485811152*^9, 3.7169604960535316`*^9}, 3.716960565375635*^9},
 CellTags->"t1",ExpressionUUID->"9be760b7-f203-4503-a07b-89b6811d788e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"NotebookLocate", "[", "\"\<t1\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CDFDeploy", "[", 
   RowBox[{"\"\<~/Desktop/test.cdf\>\"", ",", 
    RowBox[{"NotebookSelection", "[", "]"}], ",", 
    RowBox[{"Method", "\[Rule]", "\"\<Standalone\>\""}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.716954103985676*^9, 3.7169541526178627`*^9}, {
  3.716954199479727*^9, 
  3.71695420535859*^9}},ExpressionUUID->"fbc43faf-9e73-455c-a281-\
269efb206a8b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finite difference method", "Section",
 CellChangeTimes->{{3.715918723257801*^9, 3.715918734529282*^9}, {
  3.715918785309805*^9, 3.715918796733087*^9}, {3.7166588731883698`*^9, 
  3.716658877538979*^9}},ExpressionUUID->"b47c9bd1-291d-4519-9d42-\
5fdab46fe9c8"],

Cell[TextData[{
 StyleBox["Kapper and Honig, ",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["PROTEINS: Structurem Function, and Genetics",
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[", 1, 47-59, 1986",
  FontColor->RGBColor[0, 0, 1]],
 "\n\nE(r) = -\[Del]\[Phi](r)\nD(r) = \[Epsilon](r)E(r) = \
-\[Epsilon](r)\[Del]\[Phi](r)\n\n\[Del]\[CenterDot]D(r) = q(r)\n\[Del]\
\[CenterDot]\[Epsilon](r)\[Del]\[Phi](r) + q = 0\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"q", "=", 
    RowBox[{
     SubscriptBox["q", "fixed"], "+", 
     SubscriptBox["q", "free"]}]}], TraditionalForm]],ExpressionUUID->
  "628087a6-b472-4302-8a71-46bd84f690d3"],
 "\n\n",
 Cell[BoxData[
  FormBox[
   SubscriptBox["q", "free"], TraditionalForm]],ExpressionUUID->
  "80675b52-fca7-4948-b5d6-48da5116ae42"],
 " can be modeled by a Boltzmann distribution, giving:\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["q", "free"], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], 
       SuperscriptBox["Ze\[Rho]", "0"], 
       RowBox[{"sinh", "(", 
        RowBox[{"\[Beta]eZ\[Phi]", "(", "r", ")"}], ")"}]}], " ", "=", " ", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         OverscriptBox["\[Kappa]", "_"], "2"]}], 
       RowBox[{"sinh", "[", 
        RowBox[{"\[Psi]", "(", "z", ")"}], "]"}]}]}]}], " "}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"         ", 
    RowBox[{"=", "  ", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        OverscriptBox["\[Kappa]", "_"], "2"]}], 
      RowBox[{
       RowBox[{"\[Psi]", "(", "z", ")"}], "[", 
       RowBox[{
        RowBox[{"1", "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"\[Psi]", "(", "z", ")"}], "2"], "6"], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"\[Psi]", "(", "r", ")"}], "4"], "120"], "+"}], " ", 
        "..."}], "]"}]}]}]}], TraditionalForm]}],ExpressionUUID->
  "536a886f-3a18-4c7e-968c-47c977c6b28c"],
 "\t\n, where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     OverscriptBox["\[Kappa]", "_"], "2"], " ", "=", " ", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Epsilon]", "r"], 
      SuperscriptBox["\[Kappa]", "2"]}], " ", "=", " ", 
     StyleBox[
      FractionBox[
       RowBox[{"2", 
        SuperscriptBox["Z", "2"], 
        SuperscriptBox["e", "2"], 
        SuperscriptBox["\[Rho]", "0"]}], 
       RowBox[{
        SubscriptBox["\[Epsilon]", "0"], 
        SubscriptBox["k", "B"], "T"}]],
      FontSize->24]}]}], TraditionalForm]],ExpressionUUID->
  "bdfd9f4b-7f3e-4e3a-a1c9-ec09d1400813"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Del]", "\[CenterDot]", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "r"], "(", "r", ")"}]}], 
       RowBox[{"\[Del]", 
        RowBox[{"\[Phi]", "(", "r", ")"}]}]}], "-", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["\[Kappa]", "_"], "2"], 
       RowBox[{"\[Phi]", "(", "r", ")"}]}], " ", "+", " ", 
      StyleBox[
       FractionBox[
        RowBox[{
         SubscriptBox["q", "fixed"], "(", "r", ")"}], 
        SubscriptBox["\[Epsilon]", "0"]],
       FontSize->18]}], " ", "=", " ", "0"}]}], TraditionalForm]],
  ExpressionUUID->"12b619d9-11d4-4424-b63c-919001419733"],
 "\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Integral]", 
     RowBox[{"\[Integral]", 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[Del]", "\[CenterDot]", 
         RowBox[{
          SubscriptBox["\[Epsilon]", "r"], "(", "r", ")"}]}], 
        RowBox[{"\[Del]", 
         RowBox[{"\[Phi]", "(", "r", ")"}]}], "  ", 
        SuperscriptBox["d", "3"], "r"}]}]}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{"\[Integral]", 
      RowBox[{"\[Integral]", 
       RowBox[{"\[Integral]", 
        RowBox[{
         SuperscriptBox[
          OverscriptBox["\[Kappa]", "_"], "2"], 
         RowBox[{"\[Phi]", "(", "r", ")"}], "  ", 
         SuperscriptBox["d", "3"], "r"}]}]}]}], " ", "-", 
     RowBox[{"\[Integral]", 
      RowBox[{"\[Integral]", 
       RowBox[{"\[Integral]", 
        RowBox[{
         StyleBox[
          FractionBox[
           RowBox[{
            SubscriptBox["q", "fixed"], "(", "r", ")"}], 
           SubscriptBox["\[Epsilon]", "0"]],
          FontSize->18], 
         SuperscriptBox["d", "3"], "r", " ", " "}]}]}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"03f01c3d-2fa9-4b6d-ae9b-1c46cd731146"],
 "\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[ContourIntegral]", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Epsilon]", "r"], "(", "r", ")"}], 
      RowBox[{"\[Del]", 
       RowBox[{"\[Phi]", "(", "r", ")"}]}], "  ", "dA"}]}], "=", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       OverscriptBox["\[Kappa]", "_"], "2"], 
      SubscriptBox["\[Phi]", "0"], 
      SuperscriptBox["h", "3"]}], " ", "+", " ", 
     RowBox[{
      SubscriptBox["Q", "0"], "/", 
      SubscriptBox["\[Epsilon]", "0"], " "}]}]}], TraditionalForm]],
  ExpressionUUID->"baccd374-1d5c-45be-bbb9-e05ea2adf611"],
 "\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Sum]", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Epsilon]", "i"], "(", 
       RowBox[{
        SubscriptBox["\[Phi]", "i"], "-", 
        SubscriptBox["\[Phi]", "0"]}], ")"}], "h"}]}], " ", "=", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       OverscriptBox["\[Kappa]", "_"], "2"], 
      SubscriptBox["\[Phi]", "0"], 
      SuperscriptBox["h", "3"]}], " ", "+", " ", 
     RowBox[{
      SubscriptBox["Q", "0"], "/", 
      SubscriptBox["\[Epsilon]", "0"], " ", " "}]}]}], TraditionalForm]],
  ExpressionUUID->"6809bf99-817a-4cab-b273-11844446d720"],
 "\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Phi]", "0"], " ", "=", " ", 
    StyleBox[
     FractionBox[
      RowBox[{
       RowBox[{"\[Sum]", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "i"], 
         SubscriptBox["\[Phi]", "i"]}]}], " ", "+", " ", 
       RowBox[{
        SubscriptBox["Q", "0"], "/", 
        SubscriptBox["\[Epsilon]", "0"]}]}], 
      RowBox[{
       RowBox[{"\[Sum]", 
        SubscriptBox["\[Epsilon]", "i"]}], " ", "+", " ", 
       RowBox[{
        SuperscriptBox[
         OverscriptBox["\[Kappa]", "_"], "2"], 
        SuperscriptBox["h", "2"]}]}]],
     FontSize->24]}], TraditionalForm]],ExpressionUUID->
  "21cd2d6a-6785-4ec9-83dd-21a8e75359e5"]
}], "Text",
 CellChangeTimes->{{3.716658905100999*^9, 3.716659210856593*^9}, {
   3.716659246697465*^9, 3.7166592582237577`*^9}, {3.716660341082704*^9, 
   3.716660341912652*^9}, {3.716660872278274*^9, 3.716660958674693*^9}, {
   3.7166610035435333`*^9, 3.716661354406788*^9}, {3.7166614023922586`*^9, 
   3.716661429462873*^9}, {3.7166616007384577`*^9, 3.7166616026394567`*^9}, {
   3.716661680855893*^9, 3.716661700881301*^9}, {3.7166621421939163`*^9, 
   3.7166621940881147`*^9}, {3.7166623381086884`*^9, 3.716662408648534*^9}, {
   3.7166624870502462`*^9, 3.716662512647777*^9}, {3.716673581988199*^9, 
   3.716673712190586*^9}, {3.7166737757114887`*^9, 3.716673856200279*^9}, {
   3.716673894758478*^9, 3.7166739332215443`*^9}, {3.716673981247971*^9, 
   3.7166740431017027`*^9}, {3.716674081432514*^9, 3.716674095402474*^9}, {
   3.716674165241603*^9, 3.716674221499097*^9}, {3.716674445067775*^9, 
   3.7166745259339333`*^9}, {3.716674583539241*^9, 3.716674583552155*^9}, {
   3.7166746586360903`*^9, 3.7166747432497263`*^9}, {3.716674787786536*^9, 
   3.716674856561558*^9}, {3.716674906447172*^9, 3.716674914020419*^9}, {
   3.716674982722707*^9, 3.716675141646165*^9}, {3.716675172443878*^9, 
   3.7166751795214567`*^9}, {3.7166752362460423`*^9, 3.716675248512092*^9}, {
   3.716675411384005*^9, 3.716675518527478*^9}, {3.716675593433703*^9, 
   3.716675605280055*^9}, {3.716675640040947*^9, 3.7166757203917637`*^9}, {
   3.716679234534627*^9, 3.7166792655960083`*^9}, 3.7166793125518007`*^9, {
   3.7166817613572397`*^9, 3.716681762996936*^9}, {3.716737311428887*^9, 
   3.716737377863533*^9}, 3.716738955159464*^9},
 FontFamily->"Times New Roman",
 FontSize->16,ExpressionUUID->"50a6227d-347d-443b-a99f-35fc55015f55"]
}, Open  ]]
},
WindowSize->{826, 511},
WindowMargins->{{Automatic, 142}, {Automatic, 15}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "t1"->{
  Cell[144823, 3743, 1879, 40, 305, "Output",ExpressionUUID->"9be760b7-f203-4503-a07b-89b6811d788e",
   CellTags->"t1"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"t1", 156082, 4052}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 231, 4, 67, "Section",ExpressionUUID->"226fa7c5-2ce5-426c-8770-c3176bdd5439"],
Cell[CellGroupData[{
Cell[836, 30, 164, 3, 54, "Subsection",ExpressionUUID->"75d726f2-f504-43cc-8e29-0639c8c4913a"],
Cell[1003, 35, 71531, 1907, 2460, "Text",ExpressionUUID->"26917905-525d-42f0-8f97-f212cd05b956"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72571, 1947, 302, 7, 54, "Subsection",ExpressionUUID->"c037485b-c373-4a13-baa5-e70f739badae"],
Cell[72876, 1956, 2584, 89, 135, "Text",ExpressionUUID->"d4f3f845-1b60-4c0e-829e-0f8d822909af"],
Cell[75463, 2047, 619, 13, 30, "Input",ExpressionUUID->"fe25eed4-33e7-4f33-9f0c-a4d3b5b3338a"],
Cell[76085, 2062, 3016, 65, 136, "Input",ExpressionUUID->"b68d89e2-c0fe-4f0a-b2ce-cf45f8bfb3a4"],
Cell[79104, 2129, 4366, 119, 220, "Input",ExpressionUUID->"20463906-dcd3-449d-9d12-8c769300380e"],
Cell[83473, 2250, 4364, 120, 224, "Input",ExpressionUUID->"0a4aab8b-083a-4bf4-80d6-3e6ede3dbf85"],
Cell[87840, 2372, 2059, 63, 136, "Input",ExpressionUUID->"31a1d702-f245-4864-9d6c-6766501c0893"],
Cell[89902, 2437, 1051, 31, 94, "Input",ExpressionUUID->"485bce19-e712-48d3-b360-dcadfc8e884f"],
Cell[90956, 2470, 2943, 65, 131, "Input",ExpressionUUID->"a4d6f81a-02d4-4f6a-874d-6ac260c3f0fd"],
Cell[93902, 2537, 2082, 54, 94, "Input",ExpressionUUID->"db8bb487-19e3-442d-9f9b-6b733ff18187"],
Cell[CellGroupData[{
Cell[96009, 2595, 512, 14, 30, "Input",ExpressionUUID->"49326a43-9885-4ca8-8e6c-0a02176b3109"],
Cell[96524, 2611, 1779, 36, 431, "Output",ExpressionUUID->"f49efdb5-440a-4519-90f3-63c09f8c1451"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[98352, 2653, 373, 7, 54, "Subsection",ExpressionUUID->"80e60dd9-7b28-4e09-9425-ef68e147188e"],
Cell[98728, 2662, 432, 12, 30, "Input",ExpressionUUID->"87b63b1b-bfd9-448a-9548-368de7099e87"],
Cell[99163, 2676, 2020, 62, 136, "Input",ExpressionUUID->"362aa3db-2c26-4923-8a31-2547573cd422"],
Cell[CellGroupData[{
Cell[101208, 2742, 6306, 156, 421, "Input",ExpressionUUID->"b313ebfc-f7ea-4427-b7c5-596f66a66722"],
Cell[CellGroupData[{
Cell[107539, 2902, 539, 10, 24, "Print",ExpressionUUID->"144a0456-5981-460d-b033-dde042701007"],
Cell[108081, 2914, 541, 10, 24, "Print",ExpressionUUID->"4a962e60-2894-482f-bd0f-d7dae5ccf59d"],
Cell[108625, 2926, 539, 10, 24, "Print",ExpressionUUID->"59669683-56be-4537-8ad1-a96feb0de91e"],
Cell[109167, 2938, 543, 10, 24, "Print",ExpressionUUID->"92870cee-c699-4652-9e0f-8cf373b951d8"],
Cell[109713, 2950, 541, 10, 24, "Print",ExpressionUUID->"680a8925-9185-4465-aaa7-d8ad505ee200"],
Cell[110257, 2962, 539, 10, 24, "Print",ExpressionUUID->"f5da5fea-a389-4ae1-8e57-15b1348df931"]
}, Open  ]]
}, Open  ]],
Cell[110823, 2976, 2804, 63, 141, "Input",ExpressionUUID->"4bbbc0f0-da54-4b63-9ba6-cf2cb32431f6"],
Cell[113630, 3041, 2129, 55, 94, "Input",ExpressionUUID->"c6a629a9-9b35-4ccf-b780-03ec31ea29f2"],
Cell[CellGroupData[{
Cell[115784, 3100, 512, 14, 30, "Input",ExpressionUUID->"432b6aa1-67d8-452b-8224-2ea24fb8e292"],
Cell[116299, 3116, 1790, 36, 431, "Output",ExpressionUUID->"62837037-ae30-4189-a76f-221f1870e85c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[118138, 3158, 382, 6, 38, "Subsection",ExpressionUUID->"5ed9799f-cbc9-4bab-ac5c-ab79806ed1b3"],
Cell[CellGroupData[{
Cell[118545, 3168, 2352, 61, 152, "Input",ExpressionUUID->"a191d947-5346-47b2-a494-ae36ee437cb8"],
Cell[120900, 3231, 18777, 372, 259, "Output",ExpressionUUID->"0cc2e545-2a15-4b4f-89c5-5d3f418fb42b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139714, 3608, 829, 23, 52, "Input",ExpressionUUID->"c95a6334-f34e-4f2d-a72f-42b8bf0c8157"],
Cell[140546, 3633, 1939, 40, 413, "Output",ExpressionUUID->"7679d7b1-2664-4c29-ae1a-ecd32b43766b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142522, 3678, 207, 4, 30, "Input",ExpressionUUID->"0ae3d521-ba86-4ee9-b59a-95264b701b77"],
Cell[142732, 3684, 180, 3, 34, "Output",ExpressionUUID->"79aff227-d020-48d3-b50a-467d7b1f1c04"]
}, Open  ]],
Cell[142927, 3690, 1181, 30, 94, "Input",ExpressionUUID->"7df19f30-ffcc-4f04-ab85-e329af9113ff"],
Cell[CellGroupData[{
Cell[144133, 3724, 687, 17, 52, "Input",ExpressionUUID->"9e187865-65bc-4c36-ac8c-f494da26d1e3"],
Cell[144823, 3743, 1879, 40, 305, "Output",ExpressionUUID->"9be760b7-f203-4503-a07b-89b6811d788e",
 CellTags->"t1"]
}, Open  ]],
Cell[146717, 3786, 491, 11, 52, "Input",ExpressionUUID->"fbc43faf-9e73-455c-a281-269efb206a8b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[147257, 3803, 266, 4, 67, "Section",ExpressionUUID->"b47c9bd1-291d-4519-9d42-5fdab46fe9c8"],
Cell[147526, 3809, 8236, 229, 589, "Text",ExpressionUUID->"50a6227d-347d-443b-a99f-35fc55015f55"]
}, Open  ]]
}
]
*)

